<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kiro Account Manager</title>
  <style>
    
  :root {
    /* Brand Colors */
    --accent: #3fb68b;
    --accent-hover: #4ec9a0;
    --accent-dim: rgba(63, 182, 139, 0.12);
    --accent-glow: rgba(63, 182, 139, 0.4);
    --danger: #e55353;
    --danger-dim: rgba(229, 83, 83, 0.12);
    --warning: #d9a334;
    --warning-dim: rgba(217, 163, 52, 0.12);
    --success: #3fb68b;
    
    /* Fixed Dark Theme - same everywhere */
    --muted: #888888;
    --border: rgba(128, 128, 128, 0.2);
    --bg: #1e1e1e;
    --bg-hover: rgba(255, 255, 255, 0.05);
    --bg-active: rgba(63, 182, 139, 0.2);
    --bg-elevated: rgba(255, 255, 255, 0.03);
    --fg: #cccccc;
    --input-bg: #3c3c3c;
    --input-border: rgba(128, 128, 128, 0.3);
    
    /* Glass effect */
    --glass-bg: rgba(255, 255, 255, 0.02);
    --glass-border: rgba(255, 255, 255, 0.08);
    
    /* Spacing & Radius */
    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 10px;
    
    /* Transitions */
    --transition: 0.15s ease;
    --transition-normal: 0.2s ease;
    --transition-slow: 0.3s ease;
    
    /* Shadows */
    --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.2);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);
    
    /* Z-index layers */
    --z-base: 1;
    --z-dropdown: 10;
    --z-sticky: 20;
    --z-drawer: 50;
    --z-fab: 80;
    --z-overlay: 100;
    --z-modal: 200;
    --z-dialog: 300;
    --z-toast: 400;
  }

    
  /* Reset */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; overflow: hidden; background-color: #1e1e1e; }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    font-size: 12px;
    line-height: 1.4;
    color: var(--fg, #cccccc);
    background: var(--bg, #1e1e1e);
    background-color: #1e1e1e;
    display: flex;
    flex-direction: column;
  }
  
  .app { 
    display: flex; 
    flex-direction: column; 
    height: 100%; 
    overflow: hidden; 
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { 
    background: rgba(128,128,128,0.25); 
    border-radius: 4px; 
  }
  ::-webkit-scrollbar-thumb:hover { 
    background: rgba(128,128,128,0.4); 
  }

  /* Utility classes */
  .hidden { display: none !important; }
  .text-muted { color: var(--muted); }
  .text-accent { color: var(--accent); }
  .text-danger { color: var(--danger); }
  .font-mono { font-family: var(--vscode-editor-font-family, monospace); }

    
  /* === Buttons === */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 8px 14px;
    font-size: 11px;
    font-family: inherit;
    font-weight: 600;
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    white-space: nowrap;
    position: relative;
    overflow: hidden;
  }
  .btn:disabled { opacity: 0.5; cursor: not-allowed; }
  .btn svg { width: 14px; height: 14px; flex-shrink: 0; }
  
  .btn-primary {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    color: #fff;
    box-shadow: 0 2px 12px rgba(63,182,139,0.3);
  }
  .btn-primary:hover:not(:disabled) { 
    transform: translateY(-2px); 
    box-shadow: 0 6px 20px rgba(63,182,139,0.4);
  }
  
  .btn-secondary {
    background: var(--glass-bg);
    backdrop-filter: blur(8px);
    color: var(--fg);
    border: 1px solid var(--glass-border);
  }
  .btn-secondary:hover:not(:disabled) { 
    background: rgba(128,128,128,0.15); 
    border-color: var(--border);
    transform: translateY(-1px);
  }
  
  .btn-danger { 
    background: linear-gradient(135deg, var(--danger) 0%, #f06b6b 100%); 
    color: #fff; 
  }
  
  .btn-icon { padding: 8px 10px; }

  /* === Icon Button === */
  .icon-btn {
    width: 28px; 
    height: 28px;
    display: flex; 
    align-items: center; 
    justify-content: center;
    background: transparent;
    border: 1px solid transparent;
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--muted);
    transition: all var(--transition);
  }
  .icon-btn:hover { 
    background: var(--bg-elevated); 
    border-color: var(--border); 
    color: var(--fg);
    transform: scale(1.05);
  }
  .icon-btn svg { width: 14px; height: 14px; }

  /* === Inputs === */
  .form-group { margin-bottom: 14px; }
  .form-group:last-child { margin-bottom: 0; }
  
  .form-label {
    display: block;
    font-size: 11px;
    font-weight: 600;
    margin-bottom: 6px;
    color: var(--fg);
  }
  
  .form-input {
    width: 100%;
    padding: 8px 10px;
    font-size: 12px;
    font-family: inherit;
    background: var(--input-bg);
    color: var(--fg);
    border: 1px solid var(--input-border);
    border-radius: var(--radius-sm);
    outline: none;
    transition: all var(--transition);
  }
  .form-input:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(63,182,139,0.15);
  }
  .form-input::placeholder { color: var(--muted); }
  
  .form-hint {
    font-size: 10px;
    color: var(--muted);
    margin-top: 4px;
  }
  
  .form-row {
    display: flex;
    gap: 10px;
  }
  .form-row .flex-1 { flex: 1; }
  .form-row .flex-2 { flex: 2; }

  /* === Toggle === */
  .toggle {
    position: relative;
    display: inline-block;
    width: 36px;
    height: 20px;
  }
  .toggle input { opacity: 0; width: 0; height: 0; }
  .toggle-slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background: rgba(128,128,128,0.3);
    border-radius: 10px;
    transition: all var(--transition);
  }
  .toggle-slider::before {
    content: '';
    position: absolute;
    height: 14px;
    width: 14px;
    left: 3px;
    bottom: 3px;
    background: #fff;
    border-radius: 50%;
    transition: all var(--transition);
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
  }
  .toggle input:checked + .toggle-slider { background: var(--accent); }
  .toggle input:checked + .toggle-slider::before { transform: translateX(16px); }

  /* === Spinner === */
  .spinner {
    width: 14px; 
    height: 14px;
    border: 2px solid rgba(255,255,255,0.3);
    border-top-color: #fff;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* === Select === */
  .select {
    padding: 6px 28px 6px 10px;
    font-size: 11px;
    font-family: inherit;
    font-weight: 500;
    background: var(--input-bg);
    color: var(--fg);
    border: 1px solid var(--input-border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23888' d='M6 8L2 4h8z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 8px center;
    transition: all var(--transition);
  }
  .select:hover { border-color: var(--accent); }

  /* === Number Input === */
  .input-number {
    width: 70px;
    padding: 6px 8px;
    font-size: 12px;
    font-family: inherit;
    font-weight: 600;
    text-align: center;
    background: var(--input-bg);
    color: var(--fg);
    border: 1px solid var(--input-border);
    border-radius: var(--radius-sm);
    transition: all var(--transition);
  }
  .input-number:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(63,182,139,0.15);
  }
  .input-number::-webkit-inner-spin-button,
  .input-number::-webkit-outer-spin-button {
    opacity: 1;
  }

  /* === Patch Indicator === */
  .patch-indicator {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    font-size: 10px;
    border-radius: 50%;
    cursor: pointer;
    transition: all var(--transition);
    opacity: 0;
  }
  .patch-indicator.visible { opacity: 1; }
  .patch-indicator.patched {
    background: var(--accent-dim);
    color: var(--accent);
  }
  .patch-indicator.patched::after { content: 'ðŸ”§'; font-size: 9px; }
  .patch-indicator.not-patched {
    background: var(--warning-dim, rgba(229, 192, 123, 0.15));
    color: var(--warning);
  }
  .patch-indicator.not-patched::after { content: 'âš '; font-size: 9px; }
  .patch-indicator.error {
    background: var(--danger-dim);
    color: var(--danger);
  }
  .patch-indicator.error::after { content: 'âœ—'; font-size: 9px; }
  .patch-indicator:hover {
    transform: scale(1.1);
  }

    
  /* === Hero Dashboard === */
  .hero {
    margin: 10px 12px;
    padding: 14px;
    background: linear-gradient(135deg, rgba(63,182,139,0.1) 0%, rgba(63,182,139,0.03) 100%);
    border: 1px solid rgba(63,182,139,0.25);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
  }
  .hero:hover {
    border-color: rgba(63,182,139,0.4);
    box-shadow: 0 4px 20px rgba(63,182,139,0.15);
    transform: translateY(-1px);
  }
  .hero.empty {
    background: var(--glass-bg);
    border-color: var(--glass-border);
    cursor: pointer;
    text-align: center;
    padding: 20px;
  }
  .hero.empty .hero-hint {
    font-size: 11px;
    color: var(--muted);
    margin-top: 6px;
  }
  .hero.profile {
    background: linear-gradient(135deg, rgba(100,149,237,0.1) 0%, rgba(100,149,237,0.03) 100%);
    border-color: rgba(100,149,237,0.25);
  }
  .hero.profile:hover {
    border-color: rgba(100,149,237,0.4);
    box-shadow: 0 4px 20px rgba(100,149,237,0.15);
  }
  .hero.warning {
    background: linear-gradient(135deg, rgba(217,163,52,0.15) 0%, rgba(217,163,52,0.05) 100%);
    border-color: rgba(217,163,52,0.4);
  }
  .hero.critical {
    background: linear-gradient(135deg, rgba(229,83,83,0.15) 0%, rgba(229,83,83,0.05) 100%);
    border-color: rgba(229,83,83,0.4);
    animation: criticalPulse 2s ease-in-out infinite;
  }
  @keyframes criticalPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(229,83,83,0.3); }
    50% { box-shadow: 0 0 0 4px rgba(229,83,83,0.1); }
  }
  .hero-main {
    text-align: center;
    padding: 8px 0;
  }
  .hero-remaining {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .hero-remaining-value {
    font-size: 32px;
    font-weight: 700;
    line-height: 1;
    letter-spacing: -1px;
  }
  .hero-remaining-value.low { color: var(--accent); }
  .hero-remaining-value.medium { color: var(--warning); }
  .hero-remaining-value.high { color: var(--danger); }
  .hero-remaining-label {
    font-size: 10px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 4px;
  }
  .hero-profile-info {
    margin-bottom: 8px;
  }
  .hero-profile-email {
    font-size: 11px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .hero.progress {
    background: linear-gradient(135deg, rgba(63,182,139,0.08) 0%, transparent 100%);
    cursor: default;
  }
  .hero-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .hero-email {
    font-size: 13px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 70%;
  }
  .hero-days {
    font-size: 10px;
    color: var(--muted);
    font-weight: 500;
  }
  .hero-step {
    font-size: 11px;
    color: var(--accent);
    font-weight: 600;
  }
  .hero-progress {
    height: 6px;
    background: rgba(128,128,128,0.15);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 8px;
  }
  .hero-progress-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.4s ease;
  }
  .hero-progress-fill.low { background: linear-gradient(90deg, var(--accent), var(--accent-hover)); }
  .hero-progress-fill.medium { background: linear-gradient(90deg, var(--warning), #e5b84a); }
  .hero-progress-fill.high { background: linear-gradient(90deg, var(--danger), #f06b6b); }
  .hero-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 11px;
  }
  .hero-usage {
    color: var(--muted);
  }
  
  /* === Step Indicators (Registration Progress) === */
  .step-indicators {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0;
    margin: 12px 0;
    padding: 8px 4px;
    background: rgba(0,0,0,0.2);
    border-radius: var(--radius-md);
  }
  .step-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    min-width: 36px;
  }
  .step-icon {
    font-size: 14px;
    opacity: 0.4;
    transition: all 0.3s ease;
  }
  .step-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--muted);
    opacity: 0.3;
    transition: all 0.3s ease;
  }
  .step-line {
    flex: 1;
    height: 2px;
    background: var(--muted);
    opacity: 0.2;
    min-width: 8px;
    max-width: 20px;
  }
  .step-indicator.done .step-icon { opacity: 1; }
  .step-indicator.done .step-dot { 
    background: var(--accent); 
    opacity: 1;
    box-shadow: 0 0 8px var(--accent-glow);
  }
  .step-indicator.active .step-icon { 
    opacity: 1; 
    animation: stepPulse 1s ease-in-out infinite;
  }
  .step-indicator.active .step-dot { 
    background: var(--accent); 
    opacity: 1;
    animation: stepGlow 1s ease-in-out infinite;
  }
  .step-indicator.error .step-icon { opacity: 1; }
  .step-indicator.error .step-dot { 
    background: var(--danger); 
    opacity: 1;
    animation: stepError 0.5s ease-in-out infinite;
  }
  @keyframes stepPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
  }
  @keyframes stepGlow {
    0%, 100% { box-shadow: 0 0 4px var(--accent-glow); }
    50% { box-shadow: 0 0 12px var(--accent-glow); }
  }
  @keyframes stepError {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  .hero-percent {
    font-weight: 700;
    color: var(--accent);
  }

  /* === Toolbar === */
  .toolbar {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
  }
  .toolbar-buttons {
    display: flex;
    gap: 6px;
  }
  .toolbar-buttons .btn-primary { flex: 1; }

  /* === Account List === */
  .list {
    flex: 1;
    overflow-y: auto;
    padding: 8px 12px 100px;
  }
  .list-group {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 4px;
    font-size: 10px;
    font-weight: 600;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .list-group.danger { color: var(--danger); }
  .list-group.warning { color: var(--warning); }
  .list-group.banned { color: #ff0000; }
  .list-group.warning .list-group-action {
    background: rgba(217, 163, 52, 0.15);
    color: var(--warning);
  }
  .list-group.warning .list-group-action:hover {
    background: var(--warning);
    color: #000;
  }
  .list-group.banned .list-group-action {
    background: rgba(255, 0, 0, 0.15);
    color: #ff0000;
  }
  .list-group.banned .list-group-action:hover {
    background: #ff0000;
    color: #fff;
  }
  .list-group-count {
    padding: 2px 6px;
    background: var(--bg-elevated);
    border-radius: 8px;
    font-size: 9px;
  }
  .list-group-action {
    margin-left: auto;
    padding: 3px 8px;
    font-size: 9px;
    font-weight: 600;
    background: var(--danger-dim);
    color: var(--danger);
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition);
  }
  .list-group-action:hover {
    background: var(--danger);
    color: #fff;
  }

  /* === Account Card === */
  .account {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    margin-bottom: 6px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
  }
  .account:hover {
    border-color: rgba(63,182,139,0.3);
    background: linear-gradient(135deg, rgba(63,182,139,0.06) 0%, transparent 100%);
    transform: translateY(-1px);
  }
  .account.active {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--accent-dim) 0%, transparent 100%);
  }
  .account.expired { opacity: 0.6; border-color: var(--muted); }
  .account.exhausted { opacity: 0.6; border-color: var(--danger); }
  .account.suspended { opacity: 0.5; border-color: #8b0000; }
  .account-avatar {
    position: relative;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    color: #fff;
    flex-shrink: 0;
  }
  .account-status {
    position: absolute;
    bottom: -2px;
    right: -2px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid var(--bg);
  }
  .account-status.active { background: var(--accent); }
  .account-status.ready { background: #666; }
  .account-status.expired { background: var(--muted); }
  .account-status.exhausted { background: var(--danger); }
  .account-status.suspended { background: #8b0000; }
  .account-info { flex: 1; min-width: 0; }
  .account-email {
    font-size: 11px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .account-meta {
    display: flex;
    gap: 10px;
    margin-top: 3px;
    font-size: 10px;
    color: var(--muted);
  }
  .account-meta span {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .account-meta svg { width: 10px; height: 10px; }
  .account-actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity var(--transition);
  }
  .account:hover .account-actions { opacity: 1; }
  .account-btn {
    width: 26px;
    height: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--muted);
    transition: all var(--transition);
  }
  .account-btn:hover {
    background: rgba(128,128,128,0.2);
    color: var(--fg);
  }
  .account-btn.danger:hover {
    background: var(--danger-dim);
    border-color: var(--danger);
    color: var(--danger);
  }
  .account-btn svg { width: 12px; height: 12px; }

  /* === Account Checkbox (Selection Mode) === */
  .account-checkbox {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    margin-right: 6px;
    cursor: pointer;
  }
  .account-checkbox input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
  }
  .account-checkbox .checkmark {
    width: 16px;
    height: 16px;
    border: 2px solid var(--muted);
    border-radius: 3px;
    background: transparent;
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .account-checkbox:hover .checkmark {
    border-color: var(--accent);
  }
  .account-checkbox input:checked ~ .checkmark {
    background: var(--accent);
    border-color: var(--accent);
  }
  .account-checkbox input:checked ~ .checkmark::after {
    content: 'âœ“';
    color: #fff;
    font-size: 10px;
    font-weight: bold;
  }
  .account.selected {
    background: var(--accent-dim);
    border-color: var(--accent);
  }

  /* === Bulk Actions Bar === */
  .bulk-actions-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 0;
    margin-top: 8px;
    background: linear-gradient(135deg, var(--accent-dim) 0%, rgba(63,182,139,0.05) 100%);
    border-radius: var(--radius-md);
    padding: 8px 12px;
  }
  .bulk-actions-bar.hidden {
    display: none;
  }
  .bulk-info {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: var(--accent);
    font-weight: 600;
  }
  .bulk-count {
    background: var(--accent);
    color: #fff;
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 10px;
    min-width: 18px;
    text-align: center;
  }
  .bulk-buttons {
    display: flex;
    gap: 4px;
    flex: 1;
  }
  .btn-sm {
    padding: 4px 8px;
    font-size: 10px;
  }
  #selectModeBtn.active {
    background: var(--accent-dim);
    border-color: var(--accent);
    color: var(--accent);
  }

  /* === Empty State === */
  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
  }
  .empty-state-icon {
    font-size: 40px;
    margin-bottom: 12px;
    opacity: 0.5;
  }
  .empty-state-text {
    font-size: 12px;
    margin-bottom: 16px;
  }

  /* === Overlay (Settings) === */
  .overlay {
    position: fixed;
    inset: 0;
    background: var(--bg);
    z-index: 100;
    display: none;
    flex-direction: column;
    animation: slideIn 0.25s ease;
  }
  .overlay.visible { display: flex; }
  @keyframes slideIn { 
    from { transform: translateX(100%); } 
    to { transform: translateX(0); } 
  }
  .overlay-header {
    display: flex;
    align-items: center;
    gap: 12px;
    height: 42px;
    padding: 0 12px;
    background: linear-gradient(180deg, var(--bg-elevated) 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  .overlay-back {
    padding: 6px 10px;
    font-size: 11px;
    font-weight: 600;
    background: transparent;
    border: none;
    color: var(--accent);
    cursor: pointer;
    transition: all var(--transition);
  }
  .overlay-back:hover { color: var(--accent-hover); }
  .overlay-title {
    font-size: 13px;
    font-weight: 600;
    flex: 1;
  }
  .overlay-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
  }
  .overlay-footer {
    padding: 12px 16px;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-elevated);
  }
  .overlay-version {
    font-size: 10px;
    color: var(--muted);
  }

  /* === Settings Rows === */
  .setting-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
  }
  .setting-row:last-child { border-bottom: none; }
  .setting-label {
    font-size: 12px;
    font-weight: 500;
  }
  .setting-desc {
    font-size: 10px;
    color: var(--muted);
    margin-top: 2px;
  }
  .btn-sm {
    padding: 6px 12px;
    font-size: 10px;
  }

  /* === Import/Export Section === */
  .import-export-section {
    margin-top: 20px;
    padding: 16px;
    background: linear-gradient(135deg, rgba(63, 182, 139, 0.08) 0%, rgba(63, 182, 139, 0.02) 100%);
    border: 1px solid rgba(63, 182, 139, 0.25);
    border-radius: var(--radius-md);
  }
  .import-export-section .section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }
  .import-export-section .section-icon {
    font-size: 14px;
  }
  .import-export-section .section-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--fg);
  }
  .import-export-section .section-desc {
    font-size: 10px;
    color: var(--muted);
    margin-bottom: 12px;
  }
  .import-export-actions {
    display: flex;
    gap: 8px;
  }
  .import-export-actions .btn {
    flex: 1;
  }

  /* === Danger Zone Section === */
  .danger-zone-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px dashed rgba(239, 83, 80, 0.3);
  }
  .danger-zone-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
  }
  .danger-zone-icon {
    font-size: 14px;
  }
  .danger-zone-title {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--danger);
  }
  .danger-zone-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 16px;
    background: linear-gradient(135deg, rgba(239, 83, 80, 0.08) 0%, rgba(239, 83, 80, 0.02) 100%);
    border: 1px solid rgba(239, 83, 80, 0.25);
    border-radius: var(--radius-md);
    gap: 12px;
  }
  .danger-zone-card:hover {
    border-color: rgba(239, 83, 80, 0.4);
    background: linear-gradient(135deg, rgba(239, 83, 80, 0.12) 0%, rgba(239, 83, 80, 0.04) 100%);
  }
  .danger-zone-info {
    flex: 1;
    min-width: 0;
  }
  .danger-zone-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--fg);
    margin-bottom: 4px;
  }
  .danger-zone-desc {
    font-size: 10px;
    color: var(--muted);
    line-height: 1.4;
  }
  .danger-zone-hint {
    margin-top: 10px;
    font-size: 10px;
    color: var(--muted);
    padding-left: 4px;
  }
  .danger-zone-card + .danger-zone-card {
    margin-top: 10px;
  }
  .danger-zone-actions {
    display: flex;
    gap: 6px;
    flex-shrink: 0;
  }
  .patch-card {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }
  .patch-card .danger-zone-info {
    width: 100%;
  }
  .patch-card .danger-zone-actions {
    justify-content: flex-start;
  }
  .patch-status-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
  }
  .patch-status {
    font-size: 10px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: var(--radius-sm);
    background: var(--bg-elevated);
  }
  .patch-status.success {
    color: var(--accent);
    background: var(--accent-dim);
  }
  .patch-status.warning {
    color: var(--warning);
    background: rgba(229, 192, 123, 0.15);
  }
  .patch-status.error {
    color: var(--danger);
    background: var(--danger-dim);
  }
  .machine-id-preview {
    font-size: 9px;
    font-family: monospace;
    color: var(--muted);
    background: var(--bg);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    cursor: help;
  }
  .btn-warning {
    background: linear-gradient(135deg, var(--warning) 0%, #d4a84a 100%);
    color: #1a1a1a;
    border: none;
  }
  .btn-warning:hover {
    background: linear-gradient(135deg, #e5c87a 0%, var(--warning) 100%);
  }

  /* === Modal === */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: none;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.15s ease;
  }
  .modal-overlay.visible { display: flex; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .modal {
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    width: 90%;
    max-width: 360px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    animation: modalSlideIn 0.2s ease;
  }
  @keyframes modalSlideIn { 
    from { opacity: 0; transform: scale(0.95) translateY(-10px); } 
    to { opacity: 1; transform: scale(1) translateY(0); } 
  }
  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 16px;
    border-bottom: 1px solid var(--border);
  }
  .modal-title {
    font-size: 13px;
    font-weight: 600;
  }
  .modal-close {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    color: var(--muted);
    cursor: pointer;
    font-size: 18px;
    border-radius: var(--radius-sm);
    transition: all var(--transition);
  }
  .modal-close:hover {
    background: var(--danger-dim);
    color: var(--danger);
  }
  .modal-body { padding: 16px; }
  .modal-hint {
    font-size: 10px;
    color: var(--muted);
    white-space: pre-line;
    line-height: 1.6;
    margin-bottom: 12px;
  }
  .modal-textarea {
    width: 100%;
    height: 80px;
    padding: 10px;
    font-size: 11px;
    font-family: monospace;
    background: var(--input-bg);
    color: var(--fg);
    border: 1px solid var(--input-border);
    border-radius: var(--radius-sm);
    resize: none;
    margin-bottom: 12px;
  }
  .modal-textarea:focus {
    outline: none;
    border-color: var(--accent);
  }

  /* === Dialog === */
  .dialog-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    z-index: 300;
    display: none;
    align-items: center;
    justify-content: center;
  }
  .dialog-overlay.visible { display: flex; }
  .dialog {
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 20px;
    max-width: 320px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  }
  .dialog-title {
    font-size: 13px;
    font-weight: 600;
    margin-bottom: 8px;
  }
  .dialog-text {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 16px;
  }
  .dialog-actions {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
  }

  /* === Logs Drawer === */
  .logs-drawer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--bg-elevated);
    border-top: 1px solid var(--border);
    z-index: 50;
    transform: translateY(calc(100% - 36px));
    transition: transform 0.3s ease;
  }
  .logs-drawer.open { transform: translateY(0); }
  .logs-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    cursor: pointer;
    background: rgba(0,0,0,0.2);
    user-select: none;
  }
  .logs-header:hover { background: rgba(0,0,0,0.3); }
  .logs-header-left {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .logs-title {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--muted);
  }
  .logs-count {
    font-size: 9px;
    padding: 2px 6px;
    background: var(--accent-dim);
    color: var(--accent);
    border-radius: 8px;
    font-weight: 600;
  }
  .logs-count.has-errors {
    background: var(--danger-dim);
    color: var(--danger);
  }
  .logs-toggle {
    font-size: 10px;
    color: var(--muted);
    transition: transform 0.3s ease;
  }
  .logs-drawer.open .logs-toggle { transform: rotate(180deg); }
  .logs-actions {
    display: flex;
    gap: 4px;
    padding: 4px 12px;
    justify-content: flex-end;
    background: rgba(0,0,0,0.1);
  }
  .logs-content {
    max-height: 150px;
    overflow-y: auto;
    padding: 8px 12px;
    font-family: var(--vscode-editor-font-family, monospace);
    font-size: 10px;
    line-height: 1.5;
  }
  .log-line {
    white-space: pre-wrap;
    word-break: break-all;
    padding: 1px 0;
  }
  .log-line.error { color: var(--danger); }
  .log-line.success { color: var(--accent); }
  .log-line.warning { color: var(--warning); }

  /* === Toast Container === */
  .toast-container {
    position: fixed;
    top: 50px;
    right: 12px;
    z-index: 400;
    display: flex;
    flex-direction: column;
    gap: 8px;
    pointer-events: none;
  }
  .toast {
    padding: 10px 14px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 8px;
    animation: toastSlideIn 0.3s ease;
    pointer-events: auto;
    max-width: 280px;
  }
  @keyframes toastSlideIn { 
    from { opacity: 0; transform: translateX(100%); } 
    to { opacity: 1; transform: translateX(0); } 
  }
  .toast.removing { animation: toastSlideOut 0.3s ease forwards; }
  @keyframes toastSlideOut { to { opacity: 0; transform: translateX(100%); } }
  .toast-icon { font-size: 14px; }
  .toast-message { flex: 1; }
  .toast.success { border-color: var(--accent); }
  .toast.error { border-color: var(--danger); }
  .toast.warning { border-color: var(--warning); }

  /* === Skeleton Loading === */
  .skeleton { pointer-events: none; }
  .skeleton-pulse {
    background: linear-gradient(90deg, var(--bg-elevated) 25%, rgba(128,128,128,0.15) 50%, var(--bg-elevated) 75%);
    background-size: 200% 100%;
    animation: skeletonPulse 1.5s ease-in-out infinite;
  }
  @keyframes skeletonPulse {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
  .skeleton-line { height: 12px; border-radius: 4px; margin: 4px 0; }
  .account.skeleton { opacity: 0.6; }
  .account.skeleton .account-avatar { background: var(--bg-elevated); }

  /* === Switching State === */
  .account.switching {
    opacity: 0.5;
    pointer-events: none;
    position: relative;
  }
  .account.switching::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid var(--accent);
    border-top-color: transparent;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* === Banned Account Styles === */
  .account.banned {
    opacity: 0.5;
    border-color: #8b0000;
    background: linear-gradient(135deg, rgba(139,0,0,0.1) 0%, transparent 100%);
  }
  .account-status.banned { background: #8b0000; }
  .ban-badge { margin-left: 4px; font-size: 10px; }
  .ban-reason { color: #ff6b6b; font-size: 9px; font-weight: 600; }
  .list-group.banned { color: #ff6b6b; border-color: rgba(139,0,0,0.3); }

  /* === Tab Bar Navigation === */
  .tab-bar {
    display: flex;
    gap: 2px;
    padding: 4px 8px;
    background: var(--bg-elevated);
    border-bottom: 1px solid var(--border);
  }
  .tab-item {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 8px 12px;
    background: transparent;
    border: none;
    border-radius: var(--radius-md);
    color: var(--muted);
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    transition: all var(--transition);
  }
  .tab-item:hover {
    background: rgba(128,128,128,0.1);
    color: var(--fg);
  }
  .tab-item.active {
    background: var(--accent-dim);
    color: var(--accent);
  }
  .tab-icon {
    font-size: 14px;
    line-height: 1;
  }
  .tab-icon svg {
    width: 14px;
    height: 14px;
  }
  .tab-label {
    display: none;
  }
  @media (min-width: 300px) {
    .tab-label { display: inline; }
  }
  .tab-badge {
    font-size: 9px;
    padding: 1px 5px;
    border-radius: 10px;
    background: rgba(128,128,128,0.2);
    color: var(--muted);
  }
  .tab-item.active .tab-badge {
    background: var(--accent);
    color: #fff;
  }

  /* === Tab Content Panels === */
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
  }

  /* === Settings Tab (inline mode) === */
  .settings-content {
    padding: 16px 12px;
    overflow-y: auto;
    max-height: calc(100vh - 150px);
  }
  .settings-footer {
    padding: 12px 0;
    margin-top: 16px;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .settings-version {
    font-size: 10px;
    color: var(--muted);
  }

  /* === Profiles Tab (inline mode) === */
  .profiles-tab {
    padding: 12px;
  }
  .profiles-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }
  .profiles-title {
    font-size: 14px;
    font-weight: 600;
    margin: 0;
  }
  .profiles-content {
    min-height: 100px;
  }
  .profiles-empty {
    text-align: center;
    padding: 30px 20px;
    color: var(--muted);
  }
  .profiles-empty .empty-icon {
    font-size: 32px;
    margin-bottom: 10px;
    opacity: 0.5;
  }
  .profiles-empty .empty-text {
    font-size: 12px;
    margin-bottom: 14px;
  }
  .profiles-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .profile-card {
    padding: 12px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    transition: all var(--transition);
  }
  .profile-card:hover {
    border-color: rgba(63,182,139,0.3);
  }
  .profile-card.active {
    border-color: var(--accent);
    background: var(--accent-dim);
  }
  .profile-card-header {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .profile-card-radio {
    cursor: pointer;
  }
  .radio-dot {
    width: 16px;
    height: 16px;
    border: 2px solid var(--muted);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition);
  }
  .radio-dot.checked {
    border-color: var(--accent);
    background: var(--accent);
  }
  .radio-dot.checked::after {
    content: '';
    width: 6px;
    height: 6px;
    background: #fff;
    border-radius: 50%;
  }
  .profile-card-info {
    flex: 1;
    min-width: 0;
    cursor: pointer;
  }
  .profile-card-name {
    font-size: 12px;
    font-weight: 600;
  }
  .profile-card-email {
    font-size: 10px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .profile-card-actions {
    display: flex;
    gap: 4px;
  }
  .profile-card-meta {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid var(--border);
    font-size: 10px;
    color: var(--muted);
  }
  .profile-strategy {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .profile-stats {
    color: var(--muted);
  }
  .profiles-add-btn {
    margin-top: 12px;
    width: 100%;
  }

  /* === Profile Editor Form (inline) === */
  .profile-editor-form {
    padding: 12px 0;
  }
  .profile-editor-form .editor-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
  }
  .profile-editor-form .editor-title {
    font-size: 14px;
    font-weight: 600;
  }
  .profile-editor-form .editor-content {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .profile-editor-form .editor-footer {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px solid var(--border);
  }

    
  /* === Floating Action Button === */
  .fab-container {
    position: fixed;
    bottom: 50px;
    right: 16px;
    z-index: 80;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 8px;
    transition: opacity 0.2s ease, transform 0.2s ease;
  }
  .fab-container.hidden {
    opacity: 0;
    pointer-events: none;
    transform: scale(0.8);
  }
  .fab {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    transition: all var(--transition-normal);
  }
  .fab:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 24px rgba(0,0,0,0.4);
  }
  .fab:active {
    transform: scale(0.95);
  }
  .fab-icon {
    font-size: 20px;
    line-height: 1;
  }
  .fab-primary {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    color: #fff;
  }
  .fab-primary:hover {
    background: linear-gradient(135deg, var(--accent-hover) 0%, var(--accent) 100%);
  }
  /* Pulse animation for FAB when idle */
  .fab-primary.pulse {
    animation: fabPulse 2s ease-in-out infinite;
  }
  .fab-primary.pulse:hover {
    animation: none;
  }
  @keyframes fabPulse {
    0%, 100% { 
      box-shadow: 0 4px 16px rgba(0,0,0,0.3), 0 0 0 0 rgba(63,182,139,0.4);
    }
    50% { 
      box-shadow: 0 4px 16px rgba(0,0,0,0.3), 0 0 0 8px rgba(63,182,139,0);
    }
  }
  .fab-stop {
    background: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%);
    color: #fff;
    width: 40px;
    height: 40px;
  }
  .fab-pause {
    background: linear-gradient(135deg, var(--warning) 0%, #d4a84a 100%);
    color: #1a1a1a;
    width: 40px;
    height: 40px;
  }
  .fab-container.running {
    gap: 6px;
  }
  /* Running state - remove pulse, add glow */
  .fab-container.running .fab {
    animation: fabRunningGlow 1.5s ease-in-out infinite;
  }
  @keyframes fabRunningGlow {
    0%, 100% { box-shadow: 0 4px 16px rgba(0,0,0,0.3); }
    50% { box-shadow: 0 4px 24px rgba(229,83,83,0.5); }
  }
  .fab-status {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 20px;
    font-size: 10px;
    color: var(--accent);
    font-weight: 600;
  }
  .fab-status .spinner {
    width: 12px;
    height: 12px;
  }

    
  /* === Settings Cards === */
  .settings-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    margin-bottom: 12px;
    overflow: hidden;
  }
  .settings-card-header {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 14px;
    background: rgba(0,0,0,0.15);
    border-bottom: 1px solid var(--border);
  }
  .settings-card-icon {
    font-size: 16px;
  }
  .settings-card-title {
    flex: 1;
    font-size: 12px;
    font-weight: 600;
  }
  .settings-card-body {
    padding: 4px 14px;
  }
  .settings-card .setting-row {
    padding: 10px 0;
  }
  .settings-card .setting-row:last-child {
    border-bottom: none;
  }
  
  /* Active Profile in Card */
  .settings-card .active-profile-content {
    padding: 12px 14px;
  }
  .settings-card .active-profile-empty {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .settings-card .active-profile-empty .empty-text {
    flex: 1;
    font-size: 11px;
    color: var(--muted);
  }
  .settings-card .active-profile-info {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .settings-card .active-profile-avatar {
    font-size: 24px;
  }
  .settings-card .active-profile-details {
    flex: 1;
    min-width: 0;
  }
  .settings-card .active-profile-name {
    font-size: 12px;
    font-weight: 600;
  }
  .settings-card .active-profile-email {
    font-size: 10px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .settings-card .active-profile-strategy {
    font-size: 10px;
    color: var(--muted);
    margin-top: 2px;
  }
  .settings-card .active-profile-stats {
    display: flex;
    gap: 12px;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid var(--border);
  }
  .settings-card .active-profile-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .settings-card .active-profile-stat-value {
    font-size: 14px;
    font-weight: 700;
  }
  .settings-card .active-profile-stat-value.success { color: var(--accent); }
  .settings-card .active-profile-stat-value.danger { color: var(--danger); }
  .settings-card .active-profile-stat-label {
    font-size: 9px;
    color: var(--muted);
    text-transform: uppercase;
  }

  /* Spoof Section as Card */
  .spoof-section {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    margin-bottom: 12px;
    overflow: hidden;
  }
  .spoof-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 14px;
    background: rgba(0,0,0,0.15);
  }
  .spoof-title {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .spoof-icon {
    font-size: 16px;
  }
  .spoof-details {
    padding: 12px 14px;
    border-top: 1px solid var(--border);
  }
  .spoof-details.hidden {
    display: none;
  }
  .spoof-modules {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }
  .spoof-module {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    padding: 8px;
    background: rgba(0,0,0,0.1);
    border-radius: var(--radius-sm);
  }
  .module-icon {
    font-size: 14px;
  }
  .module-name {
    font-size: 10px;
    font-weight: 600;
  }
  .module-desc {
    font-size: 9px;
    color: var(--muted);
    margin-top: 2px;
  }
  .spoof-warning {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
    padding: 8px;
    background: rgba(217,163,52,0.1);
    border-radius: var(--radius-sm);
    font-size: 10px;
    color: var(--warning);
  }

    
  /* === Stats Dashboard === */
  .stats-dashboard {
    padding: 12px;
  }
  .stats-header {
    margin-bottom: 16px;
  }
  .stats-title {
    font-size: 14px;
    font-weight: 600;
    margin: 0;
  }
  
  /* Stats Cards Grid */
  .stats-cards {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    margin-bottom: 16px;
  }
  .stat-card {
    padding: 12px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    text-align: center;
  }
  .stat-card.success { border-color: rgba(63,182,139,0.3); }
  .stat-card.danger { border-color: rgba(229,83,83,0.3); }
  .stat-card.warning { border-color: rgba(217,163,52,0.3); }
  .stat-value {
    font-size: 24px;
    font-weight: 700;
    line-height: 1;
  }
  .stat-card.success .stat-value { color: var(--accent); }
  .stat-card.danger .stat-value { color: var(--danger); }
  .stat-card.warning .stat-value { color: var(--warning); }
  .stat-label {
    font-size: 10px;
    color: var(--muted);
    text-transform: uppercase;
    margin-top: 4px;
  }

  /* Stats Sections */
  .stats-section {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    padding: 12px;
    margin-bottom: 12px;
  }
  .stats-section-title {
    font-size: 11px;
    font-weight: 600;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  /* Usage Overview */
  .usage-overview {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .usage-bar-container {
    flex: 1;
    height: 8px;
    background: rgba(128,128,128,0.2);
    border-radius: 4px;
    overflow: hidden;
  }
  .usage-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent-hover));
    border-radius: 4px;
    transition: width 0.3s ease;
  }
  .usage-numbers {
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
  }
  .usage-current { color: var(--accent); }
  .usage-separator { color: var(--muted); margin: 0 2px; }
  .usage-limit { color: var(--muted); }
  .usage-avg {
    font-size: 10px;
    color: var(--muted);
    margin-top: 8px;
  }
  .usage-avg strong { color: var(--fg); }

  /* Mini Chart */
  .mini-chart {
    display: flex;
    align-items: flex-end;
    gap: 4px;
    height: 60px;
    padding: 4px 0;
  }
  .chart-bar {
    flex: 1;
    background: linear-gradient(180deg, var(--accent) 0%, var(--accent-dim) 100%);
    border-radius: 2px 2px 0 0;
    min-height: 4px;
    transition: height 0.3s ease;
  }
  .chart-bar:hover {
    background: var(--accent);
  }
  .chart-labels {
    display: flex;
    justify-content: space-between;
    font-size: 9px;
    color: var(--muted);
    margin-top: 4px;
  }

  /* Health Bars */
  .health-bars {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .health-row {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .health-label {
    font-size: 10px;
    width: 60px;
    white-space: nowrap;
  }
  .health-bar {
    flex: 1;
    height: 6px;
    background: rgba(128,128,128,0.2);
    border-radius: 3px;
    overflow: hidden;
  }
  .health-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.3s ease;
  }
  .health-fill.success { background: var(--accent); }
  .health-fill.danger { background: var(--danger); }
  .health-fill.warning { background: var(--warning); }
  .health-percent {
    font-size: 10px;
    font-weight: 600;
    width: 32px;
    text-align: right;
  }

    
  /* === Profile Section === */
  .profiles-section {
    padding: 12px;
  }
  .profiles-section-title {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--muted);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .profiles-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .profiles-empty {
    text-align: center;
    padding: 30px 20px;
    color: var(--muted);
  }
  .profiles-empty .empty-icon {
    font-size: 36px;
    margin-bottom: 10px;
    opacity: 0.5;
  }
  .profiles-empty .empty-text {
    margin-bottom: 16px;
    font-size: 12px;
  }
  .profiles-add {
    margin-top: 10px;
    width: 100%;
  }

  /* === Profile Card === */
  .imap-profile {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    padding: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .imap-profile:hover {
    border-color: rgba(63,182,139,0.3);
    background: linear-gradient(135deg, rgba(63,182,139,0.06) 0%, transparent 100%);
    transform: translateY(-1px);
  }
  .imap-profile.active {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--accent-dim) 0%, transparent 100%);
  }
  .imap-profile.exhausted {
    opacity: 0.6;
    border-color: var(--danger);
  }
  .imap-profile.error {
    border-color: var(--danger);
  }
  .imap-profile.paused {
    opacity: 0.7;
    border-color: var(--warning);
  }

  .profile-header {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .profile-avatar {
    position: relative;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .profile-strategy-icon {
    font-size: 16px;
  }
  .profile-status-dot {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid var(--bg);
  }
  .profile-info {
    flex: 1;
    min-width: 0;
  }
  .profile-name-row {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .profile-name {
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .profile-provider {
    font-size: 9px;
    padding: 2px 6px;
    border-radius: 8px;
    background: var(--bg-elevated);
    color: var(--muted);
    font-weight: 500;
  }
  .profile-email {
    font-size: 11px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .profile-actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity var(--transition);
  }
  .imap-profile:hover .profile-actions {
    opacity: 1;
  }
  .profile-btn {
    width: 26px;
    height: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--muted);
    transition: all var(--transition);
  }
  .profile-btn:hover {
    background: rgba(128,128,128,0.2);
    color: var(--fg);
  }
  .profile-btn.danger:hover {
    background: var(--danger-dim);
    border-color: var(--danger);
    color: var(--danger);
  }
  .profile-btn svg {
    width: 14px;
    height: 14px;
  }

  .profile-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid var(--border);
  }
  .profile-strategy {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .profile-pool-stats {
    font-size: 10px;
    padding: 2px 6px;
    background: var(--accent-dim);
    color: var(--accent);
    border-radius: 8px;
  }
  .profile-stats {
    display: flex;
    gap: 12px;
  }
  .profile-stats .stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .profile-stats .stat-value {
    font-size: 12px;
    font-weight: 700;
    font-family: var(--vscode-editor-font-family, monospace);
  }
  .profile-stats .stat-label {
    font-size: 9px;
    color: var(--muted);
  }
  .profile-error {
    margin-top: 8px;
    padding: 6px 8px;
    background: var(--danger-dim);
    border-radius: var(--radius-sm);
    font-size: 10px;
    color: var(--danger);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  /* === Profile Editor === */
  .profile-editor {
    position: fixed;
    inset: 0;
    background: var(--bg);
    z-index: 200;
    display: none;
    flex-direction: column;
    animation: slideIn 0.25s ease;
  }
  .profile-editor.visible,
  .profile-editor[style*="display: flex"] {
    display: flex;
  }
  .editor-header {
    display: flex;
    align-items: center;
    gap: 12px;
    height: 42px;
    padding: 0 12px;
    background: linear-gradient(180deg, var(--bg-elevated) 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  .editor-title {
    font-size: 13px;
    font-weight: 600;
  }
  .editor-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
  }
  .editor-footer {
    padding: 12px 16px;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    background: var(--bg-elevated);
  }

  /* === Form Section === */
  .form-section {
    margin-bottom: 20px;
    padding: 14px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
  }
  .form-section-title {
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 4px;
  }
  .form-section-desc {
    font-size: 11px;
    color: var(--muted);
    margin-bottom: 12px;
  }

  /* === Strategy Selector === */
  .strategy-selector {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .strategy-option {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .strategy-option:hover {
    border-color: rgba(63,182,139,0.3);
    background: rgba(63,182,139,0.05);
  }
  .strategy-option.selected {
    border-color: var(--accent);
    background: var(--accent-dim);
  }
  .strategy-icon {
    font-size: 20px;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--glass-bg);
    border-radius: var(--radius-sm);
  }
  .strategy-content {
    flex: 1;
  }
  .strategy-label {
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 2px;
    color: var(--accent);
  }
  .strategy-desc {
    font-size: 11px;
    color: var(--muted);
    line-height: 1.4;
  }
  .strategy-example {
    font-size: 10px;
    color: var(--accent);
    font-family: var(--vscode-editor-font-family, monospace);
    margin-top: 4px;
    padding: 3px 6px;
    background: var(--accent-dim);
    border-radius: var(--radius-sm);
    display: inline-block;
  }
  .config-hint {
    font-size: 11px;
    color: var(--muted);
    padding: 10px 12px;
    background: var(--bg-elevated);
    border-radius: var(--radius-sm);
    margin-bottom: 12px;
    line-height: 1.5;
  }
  .strategy-check {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
    opacity: 0;
    transition: opacity var(--transition);
  }
  .strategy-option.selected .strategy-check {
    opacity: 1;
  }
  .strategy-check svg {
    width: 16px;
    height: 16px;
  }
  .strategy-config {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--border);
  }

  /* === Email Pool Editor === */
  .email-pool-editor {
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    overflow: hidden;
  }
  .pool-list {
    max-height: 200px;
    overflow-y: auto;
  }
  .pool-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    border-bottom: 1px solid var(--border);
    font-size: 11px;
  }
  .pool-item:last-child {
    border-bottom: none;
  }
  .pool-item.used {
    opacity: 0.6;
    background: rgba(63,182,139,0.1);
  }
  .pool-item.failed {
    background: var(--danger-dim);
  }
  .pool-status {
    font-size: 12px;
  }
  .pool-stats {
    display: flex;
    gap: 12px;
    padding: 8px 10px;
    background: var(--glass-bg);
    border-bottom: 1px solid var(--border);
    font-size: 11px;
  }
  .pool-stat {
    color: var(--muted);
  }
  .pool-stat.success {
    color: var(--success);
  }
  .pool-stat.danger {
    color: var(--danger);
  }
  .pool-email {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .pool-remove {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    color: var(--muted);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition);
  }
  .pool-remove:hover {
    background: var(--danger-dim);
    color: var(--danger);
  }
  .pool-remove:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
  .pool-add {
    display: flex;
    gap: 6px;
    padding: 8px;
    border-top: 1px solid var(--border);
  }
  .pool-add .form-input {
    flex: 1;
  }
  .pool-add .btn {
    padding: 8px 12px;
  }
  .pool-actions {
    display: flex;
    gap: 6px;
    padding: 8px;
    border-top: 1px solid var(--border);
    background: var(--glass-bg);
  }
  .pool-actions .btn {
    flex: 1;
    font-size: 10px;
  }

  /* === Password Input === */
  .password-input-wrapper {
    position: relative;
  }
  .password-input-wrapper .form-input {
    padding-right: 36px;
  }
  .password-toggle {
    position: absolute;
    right: 4px;
    top: 50%;
    transform: translateY(-50%);
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    color: var(--muted);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition);
  }
  .password-toggle:hover {
    background: var(--bg-elevated);
    color: var(--fg);
  }
  .password-toggle svg {
    width: 14px;
    height: 14px;
  }

  /* === Settings Section === */
  .setting-section {
    margin-bottom: 16px;
    padding: 14px;
    background: linear-gradient(135deg, rgba(63,182,139,0.08) 0%, transparent 100%);
    border: 1px solid rgba(63,182,139,0.2);
    border-radius: var(--radius-md);
  }
  .setting-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
  }
  .setting-section-title {
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 4px;
  }
  .setting-section-desc {
    font-size: 11px;
    color: var(--muted);
  }
  /* === Active Profile Card === */
  .active-profile-card {
    margin-bottom: 16px;
    padding: 14px;
    background: linear-gradient(135deg, rgba(63,182,139,0.1) 0%, rgba(63,182,139,0.03) 100%);
    border: 1px solid rgba(63,182,139,0.25);
    border-radius: var(--radius-lg);
  }
  .active-profile-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }
  .active-profile-label {
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--accent);
  }
  .btn-sm {
    padding: 5px 10px;
    font-size: 10px;
  }
  .active-profile-content {
    min-height: 60px;
  }
  .active-profile-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 10px;
    text-align: center;
  }
  .active-profile-empty .empty-icon {
    font-size: 24px;
    opacity: 0.5;
  }
  .active-profile-empty .empty-text {
    font-size: 11px;
    color: var(--muted);
  }
  .active-profile-info {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .active-profile-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .active-profile-details {
    flex: 1;
    min-width: 0;
  }
  .active-profile-name {
    font-size: 13px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .active-profile-email {
    font-size: 11px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 6px;
  }
  .active-profile-strategy {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 12px;
    font-size: 10px;
  }
  .active-profile-strategy .strategy-icon {
    font-size: 12px;
  }
  .active-profile-strategy .strategy-name {
    font-weight: 600;
    color: var(--accent);
  }
  .active-profile-strategy .strategy-desc {
    color: var(--muted);
    margin-left: 4px;
  }
  .active-profile-stats {
    display: flex;
    gap: 16px;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid rgba(63,182,139,0.15);
  }
  .active-profile-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .active-profile-stat-value {
    font-size: 14px;
    font-weight: 700;
    font-family: var(--vscode-editor-font-family, monospace);
  }
  .active-profile-stat-value.success { color: var(--accent); }
  .active-profile-stat-value.danger { color: var(--danger); }
  .active-profile-stat-label {
    font-size: 9px;
    color: var(--muted);
    text-transform: uppercase;
  }

  /* === Profile Card (new style) === */
  .profile-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    padding: 12px;
    transition: all 0.2s ease;
  }
  .profile-card:hover {
    border-color: rgba(63,182,139,0.3);
    background: linear-gradient(135deg, rgba(63,182,139,0.06) 0%, transparent 100%);
  }
  .profile-card.active {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--accent-dim) 0%, transparent 100%);
  }
  .profile-card-header {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .profile-card-radio {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
  .radio-dot {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 2px solid #666;
    background: transparent;
    transition: all 0.2s ease;
    flex-shrink: 0;
  }
  .profile-card-radio:hover .radio-dot {
    border-color: var(--accent);
  }
  .radio-dot.checked {
    border-color: var(--accent);
    background: var(--accent);
    box-shadow: inset 0 0 0 3px var(--bg);
  }
  .profile-card-info {
    flex: 1;
    min-width: 0;
    cursor: pointer;
  }
  .profile-card-name {
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .profile-card-email {
    font-size: 11px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .profile-card-actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity var(--transition);
  }
  .profile-card:hover .profile-card-actions {
    opacity: 1;
  }
  .profile-card-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid var(--border);
    font-size: 10px;
    color: var(--muted);
  }
  .profile-strategy {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .profile-stats {
    font-family: var(--vscode-editor-font-family, monospace);
  }
  .profiles-add-btn {
    margin-top: 12px;
    width: 100%;
  }

  /* === Form Elements === */
  .form-group {
    margin-bottom: 12px;
  }
  .form-label {
    display: block;
    font-size: 11px;
    font-weight: 600;
    color: var(--muted);
    margin-bottom: 6px;
  }
  .form-input {
    width: 100%;
    padding: 8px 10px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--fg);
    font-size: 12px;
    transition: all var(--transition);
  }
  .form-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-dim);
  }
  .form-input::placeholder {
    color: var(--muted);
    opacity: 0.6;
  }
  .form-row {
    display: flex;
    gap: 10px;
  }
  .form-row .form-group {
    flex: 1;
  }
  .form-row .form-group.flex-1 {
    flex: 1;
  }
  .form-row .form-group.flex-2 {
    flex: 2;
  }
  .form-hint {
    font-size: 10px;
    color: var(--muted);
    margin-top: 4px;
    display: none;
  }
  .form-hint .provider-name {
    color: var(--accent);
    font-weight: 600;
  }

  /* === Profiles Panel Overlay === */
  .profiles-panel {
    position: fixed;
    inset: 0;
    background: var(--bg);
    z-index: 150;
    display: none;
    flex-direction: column;
    animation: slideIn 0.25s ease;
  }
  .profiles-panel.visible {
    display: flex;
  }
  @keyframes slideIn { 
    from { transform: translateX(100%); } 
    to { transform: translateX(0); } 
  }
  .profiles-panel-header {
    display: flex;
    align-items: center;
    gap: 12px;
    height: 42px;
    padding: 0 12px;
    background: linear-gradient(180deg, var(--bg-elevated) 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  .profiles-panel-title {
    font-size: 13px;
    font-weight: 600;
    flex: 1;
  }
  .profiles-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
  }

  /* ========================================
     WIZARD STYLES
     ======================================== */
  
  .profile-editor.wizard {
    display: flex;
  }
  
  .wizard-step {
    margin-bottom: 20px;
    padding: 16px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    animation: fadeIn 0.3s ease;
  }
  .wizard-step.compact {
    padding: 12px 16px;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .step-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
  }
  .step-number {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    color: white;
    font-size: 13px;
    font-weight: 700;
    border-radius: 50%;
  }
  .step-title {
    font-size: 14px;
    font-weight: 600;
  }
  
  /* Email Input Section */
  .email-input-section {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .form-input-large {
    padding: 14px 16px;
    font-size: 15px;
    border-radius: var(--radius-md);
  }
  
  /* Provider Detection */
  .provider-detection {
    animation: fadeIn 0.3s ease;
  }
  .provider-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 14px;
    background: linear-gradient(135deg, rgba(63,182,139,0.15) 0%, rgba(63,182,139,0.05) 100%);
    border: 1px solid rgba(63,182,139,0.3);
    border-radius: 20px;
    font-size: 12px;
  }
  .provider-icon {
    font-size: 16px;
  }
  .provider-name {
    font-weight: 600;
  }
  .provider-check {
    color: var(--accent);
    font-size: 11px;
  }
  
  /* Strategy Cards */
  .recommended-strategy {
    margin-bottom: 16px;
  }
  
  .strategy-card {
    background: var(--bg-elevated);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .strategy-card:hover {
    border-color: rgba(63,182,139,0.4);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }
  .strategy-card.selected {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--accent-dim) 0%, transparent 100%);
  }
  .strategy-card.recommended {
    border-color: var(--accent);
    background: linear-gradient(135deg, rgba(63,182,139,0.12) 0%, rgba(63,182,139,0.03) 100%);
  }
  .strategy-card.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }
  
  .strategy-card-header {
    margin-bottom: 12px;
  }
  .strategy-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
    margin-bottom: 8px;
  }
  .recommended-badge {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
    color: white;
  }
  .disabled-badge {
    background: var(--danger-dim);
    color: var(--danger);
  }
  .strategy-card .strategy-title {
    font-size: 16px;
    font-weight: 700;
  }
  
  /* Strategy Diagram */
  .strategy-diagram {
    margin: 16px 0;
    padding: 16px;
    background: var(--bg);
    border-radius: var(--radius-md);
    overflow-x: auto;
  }
  .strategy-diagram.mini {
    padding: 10px;
    margin: 10px 0;
  }
  .strategy-diagram.mini .diagram-email {
    font-size: 9px;
  }
  
  .diagram-flow {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    min-width: fit-content;
  }
  .diagram-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 12px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    min-width: 120px;
  }
  .diagram-step.generated {
    border-color: rgba(63,182,139,0.3);
    background: linear-gradient(135deg, rgba(63,182,139,0.1) 0%, transparent 100%);
  }
  .diagram-step.aws {
    background: linear-gradient(135deg, rgba(255,153,0,0.15) 0%, transparent 100%);
    border-color: rgba(255,153,0,0.3);
  }
  .diagram-step.inbox {
    background: linear-gradient(135deg, rgba(66,133,244,0.15) 0%, transparent 100%);
    border-color: rgba(66,133,244,0.3);
  }
  .diagram-label {
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--muted);
  }
  .diagram-icon {
    font-size: 24px;
  }
  .diagram-email {
    font-size: 10px;
    font-family: var(--vscode-editor-font-family, monospace);
    color: var(--fg);
    white-space: nowrap;
  }
  .diagram-email .highlight {
    color: var(--accent);
    font-weight: 700;
  }
  .diagram-arrow {
    font-size: 20px;
    color: var(--muted);
    flex-shrink: 0;
  }
  
  /* Strategy Features */
  .strategy-features {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
  }
  .strategy-features.compact {
    flex-direction: column;
    gap: 4px;
    margin-bottom: 12px;
  }
  .strategy-pros, .strategy-cons {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .feature-item {
    font-size: 11px;
    padding: 4px 0;
  }
  .feature-item.pro {
    color: var(--accent);
  }
  .feature-item.con {
    color: var(--warning);
  }
  
  .strategy-select-btn {
    margin-top: 8px;
  }
  .btn-block {
    width: 100%;
  }
  
  .disabled-reason {
    font-size: 10px;
    color: var(--muted);
    text-align: center;
    padding: 8px;
    background: var(--bg);
    border-radius: var(--radius-sm);
    margin-top: 8px;
  }
  
  /* Other Strategies Toggle */
  .other-strategies {
    margin-top: 12px;
  }
  .other-strategies-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: 12px;
    color: var(--muted);
    transition: all 0.2s ease;
  }
  .other-strategies-toggle:hover {
    background: var(--glass-bg);
    color: var(--fg);
  }
  .other-strategies[open] .toggle-icon {
    transform: rotate(180deg);
  }
  .toggle-icon {
    transition: transform 0.2s ease;
  }
  .toggle-icon svg {
    width: 14px;
    height: 14px;
  }
  
  .strategies-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 12px;
    margin-top: 12px;
  }
  
  /* IMAP Settings in Wizard */
  .imap-settings {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  
  .connection-status {
    min-height: 24px;
    font-size: 11px;
    margin-top: 8px;
  }
  .connection-status.success {
    color: var(--accent);
  }
  .connection-status.error {
    color: var(--danger);
  }
  
  /* Pool Stats */
  .pool-stats {
    display: flex;
    gap: 16px;
    padding: 10px 12px;
    background: var(--bg);
    border-bottom: 1px solid var(--border);
    font-size: 11px;
  }
  .pool-count {
    color: var(--accent);
  }
  .pool-pending {
    color: var(--muted);
  }
  
  /* Optional label */
  .optional {
    font-weight: 400;
    color: var(--muted);
    font-size: 10px;
  }
  
  /* Button icon */
  .btn-icon {
    width: 36px;
    height: 36px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  
    :root {
      --accent: #3fb68b; --accent-hover: #4ec9a0; --accent-dim: rgba(63, 182, 139, 0.12); --accent-glow: rgba(63, 182, 139, 0.4);
      --danger: #e55353; --danger-dim: rgba(229, 83, 83, 0.12); --warning: #d9a334;
      --expired: #8a8a8a; --expired-dim: rgba(138, 138, 138, 0.15);
      --muted: #888888; --bg-elevated: rgba(255,255,255,0.03);
      --border-subtle: rgba(128,128,128,0.12); --border-medium: rgba(128,128,128,0.2);
      --radius-sm: 4px; --radius-md: 6px; --radius-lg: 10px;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12); --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
      --transition-fast: 0.12s ease; --transition-normal: 0.2s ease;
      --glass-bg: rgba(255,255,255,0.02); --glass-border: rgba(255,255,255,0.08);
      --fg-color: #cccccc; --bg-color: #1e1e1e; --input-bg: #3c3c3c;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: var(--vscode-font-family, 'Segoe UI', system-ui, sans-serif); font-size: 12px; line-height: 1.5; color: var(--vscode-foreground, #cccccc); background: var(--vscode-sideBar-background, #1e1e1e); min-height: 100vh; overflow-x: hidden; }
    ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: transparent; } ::-webkit-scrollbar-thumb { background: rgba(128,128,128,0.25); border-radius: 4px; }
    
    /* Ripple Effect */
    .ripple { position: relative; overflow: hidden; }
    .ripple::after { content: ''; position: absolute; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; background-image: radial-gradient(circle, var(--accent) 10%, transparent 10.01%); background-repeat: no-repeat; background-position: 50%; transform: scale(10, 10); opacity: 0; transition: transform 0.4s, opacity 0.8s; }
    .ripple:active::after { transform: scale(0, 0); opacity: 0.3; transition: 0s; }
    
    /* Header */
    .header { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: linear-gradient(180deg, var(--bg-elevated) 0%, transparent 100%); border-bottom: 1px solid var(--border-subtle); position: sticky; top: 0; z-index: 100; backdrop-filter: blur(8px); }
    .header-left { display: flex; align-items: center; gap: 10px; min-width: 0; overflow: hidden; }
    .header-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; }
    .header-badge { font-size: 10px; padding: 2px 8px; border-radius: 10px; background: var(--accent-dim); color: var(--accent); font-weight: 700; }
    .header-actions { display: flex; gap: 4px; flex-shrink: 0; margin-left: 8px; }
    
    /* Icon Button */
    .icon-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; background: transparent; border: 1px solid transparent; border-radius: var(--radius-sm); cursor: pointer; color: var(--muted); transition: all var(--transition-fast); }
    .icon-btn:hover { background: var(--bg-elevated); border-color: var(--border-subtle); color: var(--vscode-foreground, #cccccc); }
    .icon-btn svg { pointer-events: none; }
    
    /* Update Banner */
    .update-banner { display: flex; align-items: center; gap: 12px; margin: 8px 14px; padding: 12px 16px; background: linear-gradient(135deg, rgba(217, 163, 52, 0.15) 0%, rgba(229, 83, 83, 0.1) 100%); border: 1px solid rgba(217, 163, 52, 0.4); border-radius: var(--radius-lg); cursor: pointer; transition: all var(--transition-normal); animation: updatePulse 2s ease-in-out infinite; }
    .update-banner:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(217, 163, 52, 0.3); border-color: var(--warning); }
    .update-banner-icon { font-size: 24px; animation: rocketBounce 1s ease-in-out infinite; }
    .update-banner-content { flex: 1; }
    .update-banner-title { font-size: 11px; font-weight: 700; color: var(--warning); }
    .update-banner-version { font-size: 13px; font-weight: 800; margin-top: 2px; }
    .update-banner-action { font-size: 11px; font-weight: 600; color: var(--warning); padding: 6px 12px; background: rgba(217, 163, 52, 0.2); border-radius: var(--radius-sm); transition: all var(--transition-fast); }
    .update-banner:hover .update-banner-action { background: var(--warning); color: #000; }
    @keyframes updatePulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(217, 163, 52, 0.4); } 50% { box-shadow: 0 0 0 4px rgba(217, 163, 52, 0.1); } }
    @keyframes rocketBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-3px); } }
    

    
    /* Native tooltips - no custom CSS, let browser handle */
    
    /* Stats Bar */
    .stats-bar { display: flex; flex-wrap: wrap; gap: 6px 12px; padding: 6px 12px; background: var(--bg-elevated); border-bottom: 1px solid var(--border-subtle); font-size: 10px; }
    .stat-item { display: flex; align-items: center; gap: 6px; }
    .stat-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
    .stat-dot.active { background: var(--accent); box-shadow: 0 0 8px var(--accent-glow); animation: glow 2s ease-in-out infinite; }
    .stat-dot.valid { background: #666; } .stat-dot.expired { background: var(--danger); } .stat-dot.exhausted { background: var(--warning); }
    .stat-exhausted { cursor: pointer; padding: 2px 6px; border-radius: 4px; background: rgba(217, 163, 52, 0.1); transition: all var(--transition-fast); }
    .stat-exhausted:hover { background: rgba(217, 163, 52, 0.25); }
    .stat-exhausted.confirm-pending { background: var(--danger); color: #fff; animation: pulse-danger 0.5s ease-in-out infinite; }
    .stat-exhausted.confirm-pending .stat-dot { background: #fff; }
    @keyframes pulse-danger { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    .stat-delete { margin-left: 2px; opacity: 0.6; font-size: 9px; } .stat-exhausted:hover .stat-delete { opacity: 1; }
    @keyframes glow { 0%, 100% { box-shadow: 0 0 6px var(--accent-glow); } 50% { box-shadow: 0 0 12px var(--accent-glow); } }
    .stat-total { margin-left: auto; color: var(--muted); font-weight: 500; }
    
    /* Usage Card - Glassmorphism */
    .usage-card { margin: 8px 12px; padding: 10px 12px; background: linear-gradient(135deg, rgba(63,182,139,0.08) 0%, rgba(63,182,139,0.02) 100%); backdrop-filter: blur(12px); border: 1px solid rgba(63,182,139,0.2); border-radius: var(--radius-md); cursor: pointer; transition: all var(--transition-normal); position: relative; overflow: hidden; }
    .usage-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--accent), var(--accent-hover), transparent); }
    .usage-card:hover { border-color: rgba(63,182,139,0.4); box-shadow: 0 8px 32px rgba(63,182,139,0.15); transform: translateY(-2px); }
    .usage-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .usage-title { display: flex; align-items: center; gap: 4px; font-size: 9px; font-weight: 700; color: var(--accent); text-transform: uppercase; letter-spacing: 0.5px; }
    .usage-value { font-size: 14px; font-weight: 700; letter-spacing: -0.5px; }
    .usage-bar { height: 4px; background: rgba(128,128,128,0.15); border-radius: 2px; overflow: hidden; }
    .usage-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
    .usage-fill.low { background: linear-gradient(90deg, var(--accent), #4ec9a0); }
    .usage-fill.medium { background: linear-gradient(90deg, var(--warning), #e5b84a); }
    .usage-fill.high { background: linear-gradient(90deg, var(--danger), #f06b6b); }
    .usage-footer { display: flex; justify-content: space-between; margin-top: 4px; font-size: 9px; color: var(--muted); font-weight: 500; }
    
    /* Buttons - Enhanced */
    .actions { display: flex; gap: 6px; padding: 8px 12px; }
    .btn { padding: 7px 10px; font-size: 10px; font-weight: 600; font-family: inherit; border: none; border-radius: var(--radius-md); cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 4px; transition: all var(--transition-normal); white-space: nowrap; position: relative; overflow: hidden; }
    .btn::after { content: ''; position: absolute; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; background-image: radial-gradient(circle, #fff 10%, transparent 10.01%); background-repeat: no-repeat; background-position: 50%; transform: scale(10, 10); opacity: 0; transition: transform 0.5s, opacity 1s; }
    .btn:active::after { transform: scale(0, 0); opacity: 0.3; transition: 0s; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-primary { background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%); color: #fff; box-shadow: 0 2px 12px rgba(63,182,139,0.3); }
    .btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(63,182,139,0.4); }
    .btn-primary:active:not(:disabled) { transform: translateY(0); }
    .btn-secondary { background: var(--glass-bg); backdrop-filter: blur(8px); color: var(--vscode-foreground, #cccccc); border: 1px solid var(--glass-border); }
    .btn-secondary:hover:not(:disabled) { background: rgba(128,128,128,0.15); border-color: var(--border-medium); transform: translateY(-1px); }
    .btn-icon { padding: 9px 12px; } .btn svg { pointer-events: none; }
    .btn-full { width: 100%; }
    .spinner { width: 14px; height: 14px; border: 2px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    /* SSO Import */
    .sso-import-row { padding: 0 12px 6px; }
    .sso-import-panel { display: none; margin: 0 14px 12px; padding: 12px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); }
    .sso-import-panel.visible { display: block; }
    .sso-import-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 11px; font-weight: 600; }
    .sso-import-hint { font-size: 10px; color: var(--muted); margin-bottom: 10px; white-space: pre-line; line-height: 1.6; }
    .sso-input { width: 100%; height: 60px; padding: 8px; font-size: 10px; font-family: monospace; background: var(--vscode-input-background, #3c3c3c); color: var(--vscode-input-foreground, #cccccc); border: 1px solid var(--border-medium); border-radius: var(--radius-sm); resize: none; margin-bottom: 10px; }
    .sso-input:focus { outline: none; border-color: var(--accent); }
    
    /* Search Bar */
    .search-bar { padding: 8px 12px; border-bottom: 1px solid var(--border-subtle); }
    .search-wrapper { position: relative; display: flex; align-items: center; }
    .search-input { width: 100%; padding: 8px 32px 8px 32px; font-size: 11px; font-family: inherit; background: var(--vscode-input-background, #3c3c3c); color: var(--vscode-foreground, #cccccc); border: 1px solid var(--border-medium); border-radius: var(--radius-md); transition: all var(--transition-normal); }
    .search-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(63,182,139,0.15); }
    .search-input::placeholder { color: var(--muted); }
    .search-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: var(--muted); pointer-events: none; display: flex; align-items: center; }
    .search-icon svg { width: 12px; height: 12px; }
    .search-clear { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; display: none; align-items: center; justify-content: center; background: var(--bg-elevated); border: none; border-radius: 50%; cursor: pointer; color: var(--muted); font-size: 10px; transition: all var(--transition-fast); }
    .search-clear:hover { background: var(--danger-dim); color: var(--danger); }
    .search-wrapper:has(.search-input:not(:placeholder-shown)) .search-clear { display: flex; }
    
    /* Filter Bar */
    .filter-bar { display: flex; align-items: center; justify-content: space-between; padding: 8px 14px; border-bottom: 1px solid var(--border-subtle); gap: 8px; }
    .filter-tabs { display: flex; gap: 2px; background: var(--glass-bg); backdrop-filter: blur(8px); padding: 2px; border-radius: var(--radius-sm); border: 1px solid var(--glass-border); }
    .filter-tab { padding: 5px 10px; font-size: 10px; font-weight: 600; background: transparent; border: none; border-radius: 3px; cursor: pointer; color: var(--muted); transition: all var(--transition-fast); }
    .filter-tab:hover { color: var(--vscode-foreground, #cccccc); } .filter-tab.active { background: linear-gradient(135deg, var(--accent-dim) 0%, rgba(63,182,139,0.2) 100%); color: var(--accent); }
    .sort-select { padding: 5px 8px; font-size: 10px; font-family: inherit; font-weight: 500; background: var(--vscode-dropdown-background, #3c3c3c); color: var(--vscode-dropdown-foreground, #ccc); border: 1px solid var(--border-medium); border-radius: var(--radius-sm); cursor: pointer; transition: all var(--transition-fast); -webkit-appearance: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23888' d='M6 8L2 4h8z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 6px center; padding-right: 22px; }
    .sort-select:hover { border-color: var(--accent); }
    .sort-select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(63,182,139,0.15); }
    .sort-select option { background: var(--vscode-dropdown-background, #3c3c3c); color: var(--vscode-dropdown-foreground, #ccc); padding: 8px; }
    
    /* Account List */
    .list { padding: 6px 10px 180px; } .list-empty { text-align: center; padding: 30px 20px; color: var(--muted); }
    .list-empty-icon { font-size: 32px; margin-bottom: 12px; opacity: 0.5; } .list-empty-text { font-size: 12px; margin-bottom: 16px; }
    
    /* Account Card - Enhanced with animations */
    .card { background: var(--glass-bg); backdrop-filter: blur(8px); border: 1px solid var(--glass-border); border-radius: var(--radius-md); margin-bottom: 6px; transition: all var(--transition-normal); position: relative; will-change: transform, opacity; contain: layout style paint; animation: cardFadeIn 0.3s ease forwards; opacity: 0; }
    .card:nth-child(1) { animation-delay: 0s; } .card:nth-child(2) { animation-delay: 0.03s; } .card:nth-child(3) { animation-delay: 0.06s; } .card:nth-child(4) { animation-delay: 0.09s; } .card:nth-child(5) { animation-delay: 0.12s; }
    @keyframes cardFadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .card:hover { border-color: rgba(63,182,139,0.3); box-shadow: 0 4px 20px rgba(63,182,139,0.1); background: linear-gradient(135deg, rgba(63,182,139,0.06) 0%, rgba(63,182,139,0.02) 100%); transform: translateY(-1px); }
    .card.active { border-color: var(--accent); background: linear-gradient(270deg, var(--accent-dim), rgba(78,201,160,0.18), var(--accent-dim)); background-size: 200% 200%; animation: cardFadeIn 0.3s ease forwards, gradientShift 4s ease infinite; }
    @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    .card.expired { opacity: 0.7; border-color: var(--expired); background: var(--expired-dim); } .card.expired:hover { opacity: 0.85; }
    .card.exhausted { opacity: 0.6; border-color: var(--danger); background: linear-gradient(135deg, var(--danger-dim) 0%, rgba(229,83,83,0.05) 100%); } .card.exhausted:hover { opacity: 0.8; }
    .card.suspended { opacity: 0.5; border-color: #8b0000; background: rgba(139, 0, 0, 0.15); text-decoration: line-through; } .card.suspended:hover { opacity: 0.7; }
    .card.suspended .card-avatar { background: #8b0000; }
    .card.banned { opacity: 0.5; border-color: #ff0000; background: linear-gradient(135deg, rgba(255, 0, 0, 0.15) 0%, rgba(139, 0, 0, 0.1) 100%); } .card.banned:hover { opacity: 0.7; }
    .card.banned .card-avatar { background: linear-gradient(135deg, #ff0000 0%, #8b0000 100%); }
    .card.banned .card-email { text-decoration: line-through; }
    .card.removing { animation: cardSlideOut 0.3s ease forwards; }
    @keyframes cardSlideOut { to { opacity: 0; transform: translateX(-100%); height: 0; margin: 0; padding: 0; border: 0; } }
    .card-main { display: flex; align-items: center; padding: 8px 10px; gap: 8px; cursor: pointer; position: relative; overflow: hidden; }
    .card-main::after { content: ''; position: absolute; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; background-image: radial-gradient(circle, var(--accent) 10%, transparent 10.01%); background-repeat: no-repeat; background-position: 50%; transform: scale(10, 10); opacity: 0; transition: transform 0.5s, opacity 1s; }
    .card-main:active::after { transform: scale(0, 0); opacity: 0.2; transition: 0s; }
    .card-avatar { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; text-transform: uppercase; flex-shrink: 0; background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%); color: #fff; box-shadow: 0 2px 8px rgba(63,182,139,0.3); }
    .card.expired .card-avatar { background: linear-gradient(135deg, #666 0%, #888 100%); box-shadow: none; }
    .card.exhausted .card-avatar { background: linear-gradient(135deg, var(--danger) 0%, #f06b6b 100%); box-shadow: 0 2px 8px rgba(229,83,83,0.3); }
    .card-info { flex: 1; min-width: 0; }
    .card-email { font-size: 10px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .card-meta { display: flex; align-items: center; gap: 6px; margin-top: 2px; font-size: 9px; color: var(--muted); }
    .card-meta-item { display: flex; align-items: center; gap: 3px; }
    /* Mini usage bar in card */
    .card-usage-bar { width: 40px; height: 3px; background: rgba(128,128,128,0.2); border-radius: 2px; overflow: hidden; margin-left: 4px; }
    .card-usage-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
    .card-usage-fill.low { background: linear-gradient(90deg, var(--accent), var(--accent-hover)); }
    .card-usage-fill.medium { background: linear-gradient(90deg, var(--warning), #e5b84a); }
    .card-usage-fill.high { background: linear-gradient(90deg, var(--danger), #f06b6b); }
    .card-status { display: flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: 10px; font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; }
    .card-status.active { background: var(--accent-dim); color: var(--accent); } .card-status.expired { background: var(--expired-dim); color: var(--expired); } .card-status.exhausted { background: var(--danger-dim); color: var(--danger); } .card-status.suspended { background: rgba(139, 0, 0, 0.3); color: #ff4444; } .card-status.banned { background: rgba(255, 0, 0, 0.3); color: #ff0000; animation: banPulse 1.5s ease infinite; }
    @keyframes banPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(255,0,0,0.4); } 50% { box-shadow: 0 0 0 4px rgba(255,0,0,0.1); } }
    .ban-badge { margin-left: 4px; font-size: 10px; } .ban-reason { color: #ff4444; font-weight: 600; font-size: 8px; text-transform: uppercase; }
    .card-status.new { background: linear-gradient(135deg, rgba(99,102,241,0.2) 0%, rgba(139,92,246,0.2) 100%); color: #a78bfa; animation: newBadgePulse 2s ease infinite; }
    @keyframes newBadgePulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(167,139,250,0.4); } 50% { box-shadow: 0 0 0 4px rgba(167,139,250,0.1); } }
    .card-actions { display: flex; gap: 6px; opacity: 0; transition: opacity var(--transition-fast); } .card:hover .card-actions { opacity: 1; }
    .card-btn { width: 26px; height: 26px; display: flex; align-items: center; justify-content: center; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-sm); cursor: pointer; color: var(--muted); transition: all var(--transition-fast); }
    .card-btn:hover { background: rgba(128,128,128,0.2); border-color: var(--border-medium); color: var(--vscode-foreground, #cccccc); transform: scale(1.1); }
    .card-btn.danger:hover { background: var(--danger-dim); border-color: var(--danger); color: var(--danger); }
    .card-btn.highlight { background: var(--accent-dim); border-color: var(--accent); color: var(--accent); }
    .card-btn.highlight:hover { background: var(--accent); color: #fff; }
    .card-btn svg { width: 16px; height: 16px; }
    
    /* Virtual List */
    .virtual-list-viewport { overflow-y: auto; overflow-x: hidden; }
    .virtual-list-content { will-change: transform; }
    .virtual-list-spacer { pointer-events: none; }
    
    /* Progress Panel */
    .progress-panel { margin: 8px 12px; padding: 10px 12px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); }
    .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .progress-title { font-size: 10px; font-weight: 600; flex: 1; } .progress-step { font-size: 9px; color: var(--muted); }
    .progress-actions { display: flex; gap: 6px; }
    .progress-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; background: var(--bg-elevated); border: 1px solid var(--border-medium); border-radius: var(--radius-sm); cursor: pointer; font-size: 12px; color: var(--muted); transition: all var(--transition-fast); }
    .progress-btn:hover { background: rgba(128,128,128,0.2); color: var(--vscode-foreground, #cccccc); transform: scale(1.1); }
    .progress-btn.danger:hover { background: var(--danger-dim); border-color: var(--danger); color: var(--danger); }
    .progress-btn.paused { background: var(--accent-dim); border-color: var(--accent); color: var(--accent); }
    .progress-bar { height: 4px; background: rgba(128,128,128,0.15); border-radius: 2px; overflow: hidden; margin-bottom: 8px; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent-hover)); border-radius: 2px; transition: width 0.3s ease; }
    .progress-fill.paused { background: linear-gradient(90deg, var(--warning), #e5b84a); animation: none; }
    .progress-footer { display: flex; justify-content: space-between; align-items: center; }
    .progress-detail { font-size: 10px; color: var(--muted); }
    
    /* Settings Panel - Glassmorphism */
    .settings-panel { display: none; padding: 10px 12px; background: var(--glass-bg); backdrop-filter: blur(12px); border-bottom: 1px solid var(--glass-border); animation: slideDown 0.2s ease; } .settings-panel.visible { display: block; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .settings-title { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; color: var(--muted); }
    .settings-row { display: flex; align-items: center; justify-content: space-between; padding: 5px 0; }
    .settings-label { font-size: 10px; font-weight: 500; } .settings-desc { font-size: 9px; color: var(--muted); margin-top: 1px; }
    .toggle { position: relative; width: 36px; height: 20px; cursor: pointer; } .toggle input { opacity: 0; width: 0; height: 0; }
    .toggle-slider { position: absolute; inset: 0; background: rgba(128,128,128,0.3); border-radius: 10px; transition: all var(--transition-fast); }
    .toggle-slider::before { content: ''; position: absolute; width: 16px; height: 16px; left: 2px; top: 2px; background: #fff; border-radius: 50%; transition: all var(--transition-fast); }
    .toggle input:checked + .toggle-slider { background: var(--accent); } .toggle input:checked + .toggle-slider::before { transform: translateX(16px); }
    .settings-select { padding: 6px 10px; font-size: 11px; font-family: inherit; font-weight: 500; background: var(--vscode-dropdown-background, #3c3c3c); color: var(--vscode-dropdown-foreground, #cccccc); border: 1px solid var(--border-medium); border-radius: var(--radius-sm); cursor: pointer; min-width: 100px; }
    
    /* Floating Console - Fixed above footer */
    .console-floating { position: fixed; bottom: 32px; left: 0; right: 0; z-index: 99; background: var(--vscode-terminal-background, #1e1e1e); border-top: 1px solid var(--border-subtle); transition: transform 0.3s ease; }
    .console-floating.collapsed { transform: translateY(calc(100% - 28px)); }
    .console-floating.collapsed .console-toggle-icon { transform: rotate(180deg); }
    .console-toggle { display: flex; align-items: center; gap: 8px; padding: 6px 12px; cursor: pointer; background: rgba(0,0,0,0.3); border-bottom: 1px solid var(--border-subtle); user-select: none; }
    .console-toggle:hover { background: rgba(0,0,0,0.4); }
    .console-toggle-icon { font-size: 8px; color: var(--muted); transition: transform 0.3s ease; }
    .console-toggle-title { font-size: 9px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted); }
    .console-toggle-count { font-size: 9px; padding: 1px 6px; border-radius: 8px; background: var(--accent-dim); color: var(--accent); font-weight: 600; }
    .console-toggle-count.has-errors { background: var(--danger-dim); color: var(--danger); }
    .console-content { display: flex; flex-direction: column; max-height: 150px; }
    .console-actions { display: flex; gap: 4px; padding: 4px 8px; justify-content: flex-end; background: rgba(0,0,0,0.2); }
    .console-actions .icon-btn { width: 22px; height: 22px; font-size: 10px; }
    .console-body { flex: 1; overflow-y: auto; padding: 6px 10px; font-family: var(--vscode-editor-font-family, 'Consolas', monospace); font-size: 10px; line-height: 1.5; max-height: 120px; }
    .console-line { white-space: pre-wrap; word-break: break-all; } .console-line.error { color: var(--danger); } .console-line.success { color: var(--accent); } .console-line.warning { color: var(--warning); }
    
    /* Old console panel - hidden */
    .console-panel { display: none; }
    
    /* Footer */
    .footer { position: fixed; bottom: 0; left: 0; right: 0; display: flex; align-items: center; justify-content: space-between; padding: 6px 12px; background: var(--vscode-sideBar-background, #1e1e1e); border-top: 1px solid var(--border-subtle); font-size: 9px; color: var(--muted); z-index: 100; }
    .footer-version { display: flex; align-items: center; gap: 6px; font-weight: 600; color: var(--accent); background: var(--accent-dim); padding: 2px 8px; border-radius: 4px; } .footer-status { display: flex; align-items: center; gap: 4px; }
    .update-badge { color: #fff; background: var(--warning); padding: 2px 6px; border-radius: 3px; font-size: 9px; text-decoration: none; animation: pulse 1.5s infinite; } .update-badge:hover { background: var(--danger); }
    .footer-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--accent); animation: glow 2s ease-in-out infinite; }
    
    /* Dialog */
    .dialog-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index: 1000; align-items: center; justify-content: center; animation: fadeIn 0.15s ease; } .dialog-overlay.visible { display: flex; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .dialog { background: var(--vscode-editorWidget-background, #252526); border: 1px solid var(--border-medium); border-radius: var(--radius-lg); padding: 20px; max-width: 320px; box-shadow: 0 8px 32px rgba(0,0,0,0.4); animation: dialogSlideIn 0.2s ease; }
    @keyframes dialogSlideIn { from { opacity: 0; transform: scale(0.95) translateY(-10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .dialog-title { font-size: 13px; font-weight: 600; margin-bottom: 8px; } .dialog-text { font-size: 12px; color: var(--muted); margin-bottom: 16px; }
    .dialog-actions { display: flex; gap: 8px; justify-content: flex-end; }
    .dialog .btn-danger { background: linear-gradient(135deg, var(--danger) 0%, #f06b6b 100%); color: #fff; }
    .dialog .btn-danger:hover { box-shadow: 0 4px 12px rgba(229,83,83,0.4); }
    
    /* Toast notifications */
    .toast-container { position: fixed; top: 50px; right: 12px; z-index: 1001; display: flex; flex-direction: column; gap: 8px; pointer-events: none; }
    .toast { padding: 10px 14px; background: var(--vscode-editorWidget-background, #252526); border: 1px solid var(--border-medium); border-radius: var(--radius-md); box-shadow: 0 4px 16px rgba(0,0,0,0.3); font-size: 11px; display: flex; align-items: center; gap: 8px; animation: toastSlideIn 0.3s ease; pointer-events: auto; max-width: 280px; }
    @keyframes toastSlideIn { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
    .toast.removing { animation: toastSlideOut 0.3s ease forwards; }
    @keyframes toastSlideOut { to { opacity: 0; transform: translateX(100%); } }
    .toast-icon { font-size: 14px; }
    .toast-message { flex: 1; }
    .toast-action { padding: 4px 8px; font-size: 10px; font-weight: 600; background: var(--accent-dim); color: var(--accent); border: none; border-radius: 4px; cursor: pointer; transition: all var(--transition-fast); }
    .toast-action:hover { background: var(--accent); color: #fff; }
    .toast.success { border-color: var(--accent); }
    .toast.error { border-color: var(--danger); }
    .toast.warning { border-color: var(--warning); }
    
    /* Compact Mode */
    body.compact .card-main { padding: 6px 10px; } body.compact .card-avatar { width: 24px; height: 24px; font-size: 10px; } body.compact .card-meta { display: none; }
    
    /* Unknown Usage State */
    .card.unknown-usage .card-usage { color: var(--muted); }
    .usage-unknown { color: var(--muted); font-style: italic; cursor: help; }
    .usage-loading { color: var(--muted); animation: pulse 1s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    
    /* Stale Usage Indicator */
    .usage-card.stale { border-color: rgba(217, 163, 52, 0.4); background: linear-gradient(135deg, rgba(217, 163, 52, 0.1) 0%, rgba(217, 163, 52, 0.02) 100%); }
    .usage-card.stale .usage-title { color: var(--warning); }
    .stale-indicator { color: var(--warning); margin-left: 4px; cursor: help; animation: spin 2s linear infinite; display: inline-block; }
    
    /* Empty Usage Card */
    .usage-card.empty { background: var(--bg-elevated); border-color: var(--border-subtle); cursor: default; }
    .usage-card.empty .usage-title { color: var(--muted); }
    .usage-hint { font-size: 10px; color: var(--muted); margin-top: 4px; }
    
    /* Loading Usage Card */
    .usage-card.loading { opacity: 0.7; pointer-events: none; }
    .usage-card.loading::before { animation: loadingPulse 1.5s ease-in-out infinite; }
    @keyframes loadingPulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
    
    /* Narrow sidebar adaptation */
    @media (max-width: 280px) {
      .header-title { font-size: 10px; }
      .stats-bar { flex-direction: column; gap: 4px; }
      .stat-total { margin-left: 0; }
      .actions { flex-wrap: wrap; }
      .btn { flex: 1; min-width: 60px; }
      .card-actions { opacity: 1; } /* Always show on narrow */
      .settings-row { flex-direction: column; align-items: flex-start; gap: 4px; }
      .settings-row .toggle { align-self: flex-end; }
    }
    
    /* Very narrow */
    @media (max-width: 220px) {
      .card-avatar { display: none; }
      .card-status { font-size: 8px; padding: 2px 4px; }
      .usage-value { font-size: 12px; }
    }

    /* Spoofing Section */
    .spoof-section { margin-top: 16px; background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); overflow: hidden; }
    .spoof-header { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: linear-gradient(135deg, rgba(63, 182, 139, 0.08), transparent); }
    .spoof-title { display: flex; align-items: center; gap: 10px; }
    .spoof-icon { font-size: 18px; }
    .spoof-details { padding: 0 12px 12px; border-top: 1px solid var(--border-subtle); }
    .spoof-details.hidden { display: none; }
    .spoof-modules { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; margin-top: 10px; }
    .spoof-module { display: flex; align-items: center; gap: 8px; padding: 8px 10px; background: var(--glass-bg); border-radius: var(--radius-sm); border: 1px solid var(--glass-border); }
    .module-icon { font-size: 14px; flex-shrink: 0; }
    .module-info { min-width: 0; }
    .module-name { font-size: 10px; font-weight: 600; }
    .module-desc { font-size: 9px; color: var(--muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .spoof-warning { display: flex; align-items: center; gap: 6px; margin-top: 10px; padding: 8px 10px; background: rgba(217, 163, 52, 0.1); border: 1px solid rgba(217, 163, 52, 0.3); border-radius: var(--radius-sm); font-size: 10px; color: var(--warning); }
    
  </style>
</head>
<body data-lang="en">
  <div class="app">
    
    <div class="header">
      <div class="header-left">
        <span class="header-title">KIRO</span>
        <span class="header-badge">0/0</span>
        <span class="patch-indicator" id="patchIndicator" title="Kiro Patch"></span>
      </div>
      <div class="header-actions">
        <button class="icon-btn" onclick="toggleLogs()" title="Console"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M9 1H3v14h10V5l-4-4zm3 13H4V2h4v4h4v8z"/></svg></button>
        <button class="icon-btn" onclick="openSettings()" title="Configure auto-switch, browser mode, logging"><svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M9.1 4.4L8.6 2H7.4l-.5 2.4-.7.3-2-1.3-.9.8 1.3 2-.2.7-2.4.5v1.2l2.4.5.3.8-1.3 2 .8.8 2-1.3.8.3.4 2.3h1.2l.5-2.4.8-.3 2 1.3.8-.8-1.3-2 .3-.8 2.3-.4V7.4l-2.4-.5-.3-.8 1.3-2-.8-.8-2 1.3-.7-.2zM9.4 1l.5 2.4L12 2.1l2 2-1.4 2.1 2.4.4v2.8l-2.4.5L14 12l-2 2-2.1-1.4-.5 2.4H6.6l-.5-2.4L4 13.9l-2-2 1.4-2.1L1 9.4V6.6l2.4-.5L2.1 4l2-2 2.1 1.4.4-2.4h2.8zM8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg></button>
      </div>
    </div>
  
    
      <div class="hero empty" onclick="openSettings()">
        <div class="hero-email">No active</div>
        <div class="hero-hint">Click to configure</div>
      </div>
    
    
    <div class="toolbar">
      <div class="toolbar-buttons">
        <button class="btn btn-secondary" onclick="openSsoModal()" title="SSO Import">ðŸŒ</button>
        <button class="btn btn-secondary btn-icon" onclick="checkAllAccountsHealth()" title="Check Health">ðŸ©º</button>
        <button class="btn btn-secondary btn-icon" onclick="toggleSelectionMode()" title="Select" id="selectModeBtn">â˜‘ï¸</button>
        <button class="btn btn-secondary btn-icon" onclick="refresh()" title="Reload accounts and update token status"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M13.5 2v5h-5l1.8-1.8A4.5 4.5 0 1 0 12.5 8h1a5.5 5.5 0 1 1-1.6-3.9L13.5 2z"/></svg></button>
      </div>
      <div class="search-wrapper">
        <span class="search-icon"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M11.7 10.3a6 6 0 1 0-1.4 1.4l4 4 1.4-1.4-4-4zM6 10a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg></span>
        <input type="text" class="search-input" id="searchInput" placeholder="Search accounts..." oninput="searchAccounts(this.value)">
        <button class="search-clear" onclick="clearSearch()">Ã—</button>
      </div>
      <div class="bulk-actions-bar hidden" id="bulkActionsBar">
        <div class="bulk-info">
          <span class="bulk-count" id="bulkCount">0</span> selected
        </div>
        <div class="bulk-buttons">
          <button class="btn btn-secondary btn-sm" onclick="selectAllAccounts()">â˜‘ï¸</button>
          <button class="btn btn-secondary btn-sm" onclick="deselectAllAccounts()">â˜</button>
          <button class="btn btn-secondary btn-sm" onclick="exportSelectedAccounts()">ðŸ“¤</button>
          <button class="btn btn-secondary btn-sm" onclick="refreshSelectedTokens()">ðŸ”„</button>
          <button class="btn btn-danger btn-sm" onclick="deleteSelectedAccounts()">ðŸ—‘ï¸</button>
        </div>
        <button class="btn btn-secondary btn-sm" onclick="toggleSelectionMode()">âœ•</button>
      </div>
    </div>
  
    
    <div class="list" id="accountList">
      <div class="loading">Loading accounts...</div>
    </div>

    
    <div class="logs-drawer" id="logsDrawer">
      <div class="logs-header" onclick="toggleLogs()">
        <div class="logs-header-left">
          <span class="logs-title">Console</span>
          <span class="logs-count" id="logsCount">0</span>
        </div>
        <span class="logs-toggle">â–²</span>
      </div>
      <div class="logs-actions">
        <button class="icon-btn" onclick="clearConsole()" title="Clear console output">ðŸ—‘</button>
        <button class="icon-btn" onclick="copyLogs()" title="Copy logs to clipboard">ðŸ“‹</button>
      </div>
      <div class="logs-content" id="logsContent"></div>
    </div>
  
    
    <div class="overlay" id="settingsOverlay">
      <div class="overlay-content">
        <div class="overlay-header">
          <button class="overlay-back" onclick="closeSettings()">â† Back</button>
          <span class="overlay-title">Settings</span>
        </div>
        <div class="overlay-body">
    <!-- Active Profile Card -->
    <div class="settings-card" id="activeProfileCard">
      <div class="settings-card-header">
        <span class="settings-card-icon">ðŸ“§</span>
        <span class="settings-card-title">Active Profile</span>
        <button class="btn btn-secondary btn-sm" onclick="switchTab('profiles')">Change</button>
      </div>
      <div class="active-profile-content" id="activeProfileContent">
        <div class="active-profile-empty">
          <span class="empty-text">No profile configured</span>
          <button class="btn btn-primary btn-sm" onclick="switchTab('profiles')">Configure</button>
        </div>
      </div>
    </div>

    <!-- Automation Card -->
    <div class="settings-card">
      <div class="settings-card-header">
        <span class="settings-card-icon">âš™ï¸</span>
        <span class="settings-card-title">Automation</span>
      </div>
      <div class="settings-card-body">
        <div class="setting-row">
          <div>
            <div class="setting-label">Auto-switch on expiry</div>
            <div class="setting-desc">Automatically switch to next valid account</div>
          </div>
          <label class="toggle">
            <input type="checkbox"  onchange="toggleAutoSwitch(this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-row" id="autoSwitchThresholdRow" style="display:none">
          <div>
            <div class="setting-label">Switch threshold</div>
            <div class="setting-desc">Switch when remaining < this value</div>
          </div>
          <input type="number" class="input-number" id="autoSwitchThreshold" 
            value="10" 
            min="1" max="490" step="10"
            onchange="updateSetting('autoSwitchThreshold', parseInt(this.value))">
        </div>
        <div class="setting-row">
          <div>
            <div class="setting-label">Headless mode</div>
            <div class="setting-desc">Run browser in background</div>
          </div>
          <label class="toggle">
            <input type="checkbox"  onchange="toggleSetting('headless', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-row">
          <div>
            <div class="setting-label">Device Flow auth</div>
            <div class="setting-desc">Use device code instead of local server</div>
          </div>
          <label class="toggle">
            <input type="checkbox"  onchange="toggleSetting('deviceFlow', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Interface Card -->
    <div class="settings-card">
      <div class="settings-card-header">
        <span class="settings-card-icon">ðŸŽ¨</span>
        <span class="settings-card-title">Interface</span>
      </div>
      <div class="settings-card-body">
        <div class="setting-row">
          <div>
            <div class="setting-label">Language</div>
            <div class="setting-desc">Interface language</div>
          </div>
          <select class="select" onchange="changeLanguage(this.value)"><option value="en" selected>EN</option><option value="ru" >RU</option><option value="zh" >ZH</option><option value="es" >ES</option><option value="pt" >PT</option><option value="ja" >JA</option><option value="de" >DE</option><option value="fr" >FR</option><option value="ko" >KO</option><option value="hi" >HI</option></select>
        </div>
        <div class="setting-row">
          <div>
            <div class="setting-label">Verbose logging</div>
            <div class="setting-desc">Show detailed logs</div>
          </div>
          <label class="toggle">
            <input type="checkbox"  onchange="toggleSetting('verbose', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="setting-row">
          <div>
            <div class="setting-label">Screenshots on error</div>
            <div class="setting-desc">Save screenshots when errors occur</div>
          </div>
          <label class="toggle">
            <input type="checkbox"  onchange="toggleSetting('screenshotsOnError', this.checked)">
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>

    
    <div class="spoof-section">
      <div class="spoof-header">
        <div class="spoof-title">
          <span class="spoof-icon">ðŸ›¡ï¸</span>
          <div>
            <div class="setting-label">Spoofing mode</div>
            <div class="setting-desc">Randomize browser fingerprint</div>
          </div>
        </div>
        <label class="toggle">
          <input type="checkbox" id="spoofingToggle" checked onchange="toggleSpoofing(this.checked)">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="spoof-details" id="spoofDetails">
        <div class="spoof-modules">
          <div class="spoof-module">
            <span class="module-icon">ðŸ¤–</span>
            <div class="module-info">
              <div class="module-name">Automation</div>
              <div class="module-desc">Hides webdriver flags</div>
            </div>
          </div>
          <div class="spoof-module">
            <span class="module-icon">ðŸŽ¨</span>
            <div class="module-info">
              <div class="module-name">Canvas/WebGL</div>
              <div class="module-desc">Randomizes fingerprint</div>
            </div>
          </div>
          <div class="spoof-module">
            <span class="module-icon">ðŸ–¥ï¸</span>
            <div class="module-info">
              <div class="module-name">Navigator</div>
              <div class="module-desc">Spoofs hardware info</div>
            </div>
          </div>
          <div class="spoof-module">
            <span class="module-icon">ðŸ”Š</span>
            <div class="module-info">
              <div class="module-name">Audio/Fonts</div>
              <div class="module-desc">Masks audio context</div>
            </div>
          </div>
          <div class="spoof-module">
            <span class="module-icon">ðŸŒ</span>
            <div class="module-info">
              <div class="module-name">WebRTC</div>
              <div class="module-desc">Hides local IP</div>
            </div>
          </div>
          <div class="spoof-module">
            <span class="module-icon">ðŸ–±ï¸</span>
            <div class="module-info">
              <div class="module-name">Behavior</div>
              <div class="module-desc">Human-like actions</div>
            </div>
          </div>
        </div>
        <div class="spoof-warning">
          <span>âš ï¸</span>
          <span>Disabling may cause bot detection failures</span>
        </div>
      </div>
    </div>
  
    
    <div class="import-export-section">
      <div class="section-header">
        <span class="section-icon">ðŸ“¦</span>
        <span class="section-title">Export Accounts</span>
      </div>
      <div class="section-desc">Export accounts with tokens for transfer</div>
      <div class="import-export-actions">
        <button class="btn btn-primary" onclick="exportAllAccounts()">
          ðŸ“¤ Export All
        </button>
        <button class="btn btn-secondary" onclick="importAccounts()">
          ðŸ“¥ Import Accounts
        </button>
      </div>
    </div>
  
    
    <div class="danger-zone-section">
      <div class="danger-zone-header">
        <span class="danger-zone-icon">âš ï¸</span>
        <span class="danger-zone-title">Danger Zone</span>
      </div>
      
      <div class="danger-zone-card patch-card">
        <div class="danger-zone-info">
          <div class="danger-zone-label">Kiro Patch</div>
          <div class="danger-zone-desc">Patches Kiro to use custom Machine ID</div>
          <div class="patch-status-row">
            <span id="patchStatusText" class="patch-status">Loading...</span>
            <span id="currentMachineId" class="machine-id-preview"></span>
          </div>
        </div>
        <div class="danger-zone-actions">
          <button id="patchKiroBtn" class="btn btn-warning" onclick="confirmPatchKiro()" title="Patch Kiro">
            ðŸ”§ Patch
          </button>
          <button id="unpatchKiroBtn" class="btn btn-secondary" onclick="confirmUnpatchKiro()" style="display:none" title="Remove Patch">
            â†©ï¸ Remove
          </button>
          <button id="generateIdBtn" class="btn btn-secondary" onclick="generateNewMachineId()" title="New ID">
            ðŸŽ² New ID
          </button>
        </div>
      </div>
      
      <div class="danger-zone-card">
        <div class="danger-zone-info">
          <div class="danger-zone-label">Reset Machine ID</div>
          <div class="danger-zone-desc">Generate new telemetry IDs for Kiro. Use if account is banned.</div>
        </div>
        <button class="btn btn-danger" onclick="confirmResetMachineId()" title="Reset machineId, sqmId, devDeviceId and serviceMachineId">
          ðŸ”„ Reset
        </button>
      </div>
      <div class="danger-zone-hint">
        ðŸ’¡ Restart Kiro after reset
      </div>
    </div>
  
    
    <div class="settings-footer">
      <span class="settings-version">vstandalone</span>
      <a href="https://t.me/whitebite_devsoft" class="btn btn-secondary" style="text-decoration:none" title="Telegram">ðŸ“¢ TG</a>
      <button class="btn btn-secondary" onclick="checkUpdates()">Check Updates</button>
    </div>
  </div>
      </div>
    </div>
  
    
    
    <div class="modal-overlay" id="ssoModal" onclick="if(event.target === this) closeSsoModal()">
      <div class="modal">
        <div class="modal-header">
          <span class="modal-title">SSO Import</span>
          <button class="modal-close" onclick="closeSsoModal()">Ã—</button>
        </div>
        <div class="modal-body">
          <div class="modal-hint">1. Open view.awsapps.com/start
2. DevTools â†’ Application â†’ Cookies
3. Copy x-amz-sso_authn</div>
          <textarea class="modal-textarea" id="ssoTokenInput" placeholder="Paste cookie..."></textarea>
          <button class="btn btn-primary" style="width:100%" onclick="importSsoToken()">Import</button>
        </div>
      </div>
    </div>
  
    
    <div class="dialog-overlay" id="dialogOverlay" onclick="if(event.target === this) closeDialog()">
      <div class="dialog">
        <div class="dialog-title" id="dialogTitle">Delete Account</div>
        <div class="dialog-text" id="dialogText">Are you sure you want to delete this account?</div>
        <div class="dialog-actions">
          <button class="btn btn-secondary" onclick="closeDialog()">Cancel</button>
          <button class="btn btn-danger" onclick="dialogAction()">Delete</button>
        </div>
      </div>
    </div>
  
    <div class="toast-container" id="toastContainer"></div>
  
    
    
    <div class="profiles-panel" id="profilesPanel">
      <div class="profiles-panel-header">
        <button class="overlay-back" onclick="closeProfilesPanel()">â† Back</button>
        <span class="profiles-panel-title">Email Profiles</span>
      </div>
      <div class="profiles-panel-content" id="profilesContent">
        <div class="profiles-empty">
          <div class="empty-icon">ðŸ“§</div>
          <div class="empty-text">No profiles configured</div>
          <button class="btn btn-primary" onclick="createProfile()">
            <svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M7 7V1h2v6h6v2H9v6H7V9H1V7h6z"/></svg> Add Profile
          </button>
        </div>
      </div>
    </div>
  
    
    <div class="profile-editor" id="profileEditor">
      <div class="editor-header">
        <button class="overlay-back" onclick="closeProfileEditor()">â† Back</button>
        <span class="editor-title">New Profile</span>
      </div>
      <div class="editor-content">
        <div class="form-group">
          <label class="form-label">Profile Name</label>
          <input type="text" class="form-input" id="profileName" placeholder="My Gmail">
        </div>
        
        <div class="form-section" id="imapSection">
          <div class="form-section-title">IMAP</div>
          <div class="form-group" id="imapEmailGroup">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" id="imapUser" placeholder="your@email.com" oninput="onEmailInput(this.value)">
            <div class="form-hint" id="providerHint"></div>
          </div>
          <div class="form-row">
            <div class="form-group flex-2">
              <label class="form-label">Server</label>
              <input type="text" class="form-input" id="imapServer" placeholder="imap.gmail.com">
            </div>
            <div class="form-group flex-1">
              <label class="form-label">Port</label>
              <input type="number" class="form-input" id="imapPort" value="993">
            </div>
          </div>
          <div class="form-group" id="imapPasswordGroup">
            <label class="form-label">Password</label>
            <div class="password-input-wrapper">
              <input type="password" class="form-input" id="imapPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
              <button class="password-toggle" onclick="togglePasswordVisibility('imapPassword')"><svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 4C4.5 4 1.6 6.5.5 8c1.1 1.5 4 4 7.5 4s6.4-2.5 7.5-4c-1.1-1.5-4-4-7.5-4zm0 7a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg></button>
            </div>
          </div>
          <button class="btn btn-secondary" id="testConnectionBtn" onclick="testImapConnection()">ðŸ”Œ Test</button>
        </div>
        
        <div class="form-section">
          <div class="form-section-title">Email Strategy</div>
          <div class="form-section-desc">Choose how to generate emails for registration</div>
          
    <div class="strategy-selector">
      <div class="strategy-option selected" data-strategy="single" onclick="selectStrategy('single')">
        <div class="strategy-icon">ðŸ“§</div>
        <div class="strategy-content">
          <div class="strategy-label">Single Email</div>
          <div class="strategy-desc">Uses your IMAP email directly. Only 1 account per email.</div>
          <div class="strategy-example">Example: your@gmail.com â†’ your@gmail.com</div>
        </div>
        <div class="strategy-check">âœ“</div>
      </div>
      <div class="strategy-option" data-strategy="plus_alias" onclick="selectStrategy('plus_alias')">
        <div class="strategy-icon">âž•</div>
        <div class="strategy-content">
          <div class="strategy-label">Plus Alias</div>
          <div class="strategy-desc">Adds +random to your email. All emails arrive to same inbox. Works with Gmail, Outlook, Yandex.</div>
          <div class="strategy-example">Example: your@gmail.com â†’ your+kiro5x7@gmail.com</div>
        </div>
        <div class="strategy-check">âœ“</div>
      </div>
      <div class="strategy-option" data-strategy="catch_all" onclick="selectStrategy('catch_all')">
        <div class="strategy-icon">ðŸŒ</div>
        <div class="strategy-content">
          <div class="strategy-label">Catch-All Domain</div>
          <div class="strategy-desc">Generates random emails on your domain. Requires catch-all configured on mail server.</div>
          <div class="strategy-example">Example: JohnSmith4521@yourdomain.com</div>
        </div>
        <div class="strategy-check">âœ“</div>
      </div>
      <div class="strategy-option" data-strategy="pool" onclick="selectStrategy('pool')">
        <div class="strategy-icon">ðŸ“‹</div>
        <div class="strategy-content">
          <div class="strategy-label">Email Pool</div>
          <div class="strategy-desc">Use a list of your email addresses. Each email is used once in order.</div>
        </div>
        <div class="strategy-check">âœ“</div>
      </div>
    </div>
    
    <div class="strategy-config" id="catchAllConfig" style="display: none;">
      <div class="config-hint">Enter domain with catch-all configured. All emails to any@domain will arrive to your IMAP inbox.</div>
      <div class="form-group">
        <label class="form-label">Registration Domain</label>
        <input type="text" class="form-input" id="catchAllDomain" placeholder="your-domain.com">
      </div>
    </div>
    
    <div class="strategy-config" id="poolConfig" style="display: none;">
      <div class="config-hint">Add email addresses to use in order. Each email = 1 account. Format: email:password</div>
      <div class="email-pool-editor">
        <div class="pool-stats" id="poolStats"></div>
        <div class="pool-list" id="poolList"></div>
        <div class="pool-add">
          <input type="text" class="form-input" id="newPoolEmail" placeholder="email:password or email..." onkeypress="if(event.key==='Enter') addEmailToPool()" onpaste="handlePoolPaste(event)">
          <button class="btn btn-secondary" onclick="addEmailToPool()"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M7 7V1h2v6h6v2H9v6H7V9H1V7h6z"/></svg></button>
        </div>
        <div class="pool-actions">
          <button class="btn btn-secondary" onclick="importEmailsFromFile()">ðŸ“ From file</button>
          <button class="btn btn-secondary" onclick="pasteEmails()">ðŸ“‹ Paste</button>
        </div>
      </div>
    </div>
  
        </div>
      </div>
      <div class="editor-footer">
        <button class="btn btn-secondary" onclick="closeProfileEditor()">Cancel</button>
        <button class="btn btn-primary" onclick="saveProfile()">Save</button>
      </div>
    </div>
  
  </div>
  <div id="toastContainer" class="toast-container"></div>
  <script>
    // Standalone Web App Script
    // Auto-generated from VS Code extension components
    
    const T = {"kiroAccounts":"Kiro Accounts","compactViewTip":"Shrink cards to show more accounts","settingsTip":"Configure auto-switch, browser mode, logging","back":"Back","valid":"valid","expired":"expired","total":"total","noActive":"No active","validFilter":"Valid","expiredFilter":"Expired","activeGroup":"Active","readyGroup":"Ready","badGroup":"Expired / Exhausted","expiredGroup":"Expired","exhaustedGroup":"Exhausted","bannedGroup":"Banned","banned":"BANNED","refreshAll":"Refresh all","deleteAll":"Delete all","todaysUsage":"Today's Usage","used":"used","daysLeft":"days left","remaining":"remaining","resetsAtMidnight":"Resets at midnight","autoReg":"Auto-Reg","autoRegTip":"Create new AWS Builder ID automatically","import":"Import","importTip":"Import existing token from JSON file","refresh":"Refresh","refreshTip":"Reload accounts and update token status","export":"Export","exportTip":"Save all accounts to JSON file","running":"Running...","stop":"Stop","all":"All","byUsage":"By Usage","byExpiry":"By Expiry","byDate":"By Date","searchPlaceholder":"Search accounts...","newBadge":"NEW","active":"Active","copyTokenTip":"Copy access token to clipboard","refreshTokenTip":"Refresh expired token","viewQuotaTip":"Show usage statistics for this account","deleteTip":"Remove account and token file","noAccounts":"No accounts yet","createFirst":"Create First Account","console":"Console","clearTip":"Clear console output","openLogTip":"Open full log file in editor","copyLogsTip":"Copy logs to clipboard","step":"Step","connected":"Connected","confirm":"Confirm","cancel":"Cancel","deleteTitle":"Delete Account","deleteConfirm":"Are you sure you want to delete this account?","areYouSure":"Are you sure?","settingsTitle":"Settings","autoSwitch":"Auto-switch on expiry","autoSwitchDesc":"Automatically switch to next valid account","hideExhausted":"Hide exhausted","hideExhaustedDesc":"Hide accounts with 100% usage","headless":"Headless mode","headlessDesc":"Run browser in background","verbose":"Verbose logging","verboseDesc":"Show detailed logs","screenshots":"Screenshots on error","screenshotsDesc":"Save screenshots when errors occur","spoofing":"Spoofing mode","spoofingDesc":"Randomize browser fingerprint","deviceFlow":"Device Flow auth","deviceFlowDesc":"Use device code instead of local server","language":"Language","languageDesc":"Interface language","spoofAutomation":"Automation","spoofAutomationDesc":"Hides webdriver flags","spoofCanvas":"Canvas/WebGL","spoofCanvasDesc":"Randomizes fingerprint","spoofNavigator":"Navigator","spoofNavigatorDesc":"Spoofs hardware info","spoofAudio":"Audio/Fonts","spoofAudioDesc":"Masks audio context","spoofWebrtc":"WebRTC","spoofWebrtcDesc":"Hides local IP","spoofBehavior":"Behavior","spoofBehaviorDesc":"Human-like actions","spoofWarning":"Disabling may cause bot detection failures","kiroPatch":"Kiro Patch","kiroPatchDesc":"Patches Kiro to use custom Machine ID","patchStatusLoading":"Loading...","patchStatusActive":"Patched","patchStatusNotPatched":"Not patched","patch":"Patch","removePatch":"Remove","newMachineId":"New ID","patchKiroTitle":"Patch Kiro","patchKiroConfirm":"This will patch Kiro to use custom Machine ID. Close Kiro first! Continue?","removePatchTitle":"Remove Patch","removePatchConfirm":"This will restore original Kiro files. Continue?","newProfile":"New Profile","editProfile":"Edit Profile","profileName":"Profile Name","profileNamePlaceholder":"My Gmail","server":"Server","port":"Port","password":"Password","testConnection":"Test","testing":"Testing...","emailStrategy":"Email Strategy","emailStrategyDesc":"Choose how to generate emails for registration","save":"Save","createProfile":"Create Profile","enterYourEmail":"Enter your email","detected":"Detected","chooseStrategy":"Choose strategy","recommended":"Recommended","otherOptions":"Other options","useAppPassword":"Use App Password","imapConnection":"IMAP Connection","optional":"optional","checkConnection":"Check connection","strategySingleName":"Single Email","strategySingleDesc":"Uses your IMAP email directly. Only 1 account per email.","strategySingleExample":"your@gmail.com â†’ your@gmail.com","strategyPlusAliasName":"Plus Alias","strategyPlusAliasDesc":"Adds +random to your email. All emails arrive to same inbox. Works with Gmail, Outlook, Yandex.","strategyPlusAliasExample":"your@gmail.com â†’ your+kiro5x7@gmail.com","strategyCatchAllName":"Catch-All Domain","strategyCatchAllDesc":"Generates random emails on your domain. Requires catch-all configured on mail server.","strategyCatchAllExample":"JohnSmith4521@yourdomain.com","strategyCatchAllHint":"Enter domain with catch-all configured. All emails to any@domain will arrive to your IMAP inbox.","strategyCatchAllDomain":"Registration Domain","strategyPoolName":"Email Pool","strategyPoolDesc":"Use a list of your email addresses. Each email is used once in order.","strategyPoolHint":"Add email addresses to use in order. Each email = 1 account. Format: email:password","strategyPoolAdd":"email:password or email...","strategyPoolFromFile":"From file","strategyPoolPaste":"Paste","poolEmpty":"Add at least one email to pool","emailsAdded":"{count} emails added","example":"Example","unlimitedAccounts":"Unlimited accounts","allEmailsOneInbox":"All emails in one inbox","noOwnDomain":"No own domain needed","notAllProvidersSupport":"Not all providers support","uniqueEmails":"Unique email addresses","needOwnDomain":"Need own domain","needCatchAllSetup":"Need catch-all setup","easyToSetup":"Easy to setup","worksEverywhere":"Works everywhere","oneAccountPerEmail":"Only 1 account per email","worksWithAnyProvider":"Works with any provider","controlOverList":"Control over list","needManyEmails":"Need many emails","requiresDomain":"Requires own domain","providerNoAlias":"does not support aliases","activeProfile":"Active Profile","change":"Change","noProfileConfigured":"No profile configured","configure":"Configure","emailProfiles":"Email Profiles","noProfiles":"No profiles configured","addProfile":"Add Profile","success":"Success","failed":"Failed","strategySingleShort":"One account per email","strategyPlusAliasShort":"user+random@domain","strategyCatchAllShort":"Any email on domain","strategyPoolShort":"Your email list","dangerZone":"Danger Zone","resetMachineId":"Reset Machine ID","resetMachineIdDesc":"Generate new telemetry IDs for Kiro. Use if account is banned.","resetMachineIdTip":"Reset machineId, sqmId, devDeviceId and serviceMachineId","reset":"Reset","restartAfterReset":"Restart Kiro after reset","resetMachineIdTitle":"Reset Machine ID","resetMachineIdConfirm":"This will reset Kiro telemetry IDs. You need to restart Kiro after. Continue?","delete":"Delete","checkUpdates":"Check Updates","newVersion":"New version!","download":"Download","edit":"Edit","unnamed":"Unnamed","customDomain":"Custom Domain","emailPasswordHint":"Use your email password","ssoImport":"SSO Import","ssoHint":"1. Open view.awsapps.com/start\n2. DevTools â†’ Application â†’ Cookies\n3. Copy x-amz-sso_authn","pasteCookie":"Paste cookie...","providerGmail":"Gmail","providerYandex":"Yandex","providerMailru":"Mail.ru","providerOutlook":"Outlook","providerCustom":"Custom Domain","gmailPasswordHint":"Use App Password from Google Account settings","yandexPasswordHint":"Use app password from Yandex settings","mailruPasswordHint":"Create app password in Mail.ru settings","outlookPasswordHint":"Use your Microsoft account password","accountDeleted":"Account deleted","badAccountsDeleted":"Bad accounts deleted","resettingMachineId":"Resetting Machine ID...","patchingKiro":"Patching Kiro...","removingPatch":"Removing patch...","profileCreated":"Profile created","profileUpdated":"Profile updated","profileDeleted":"Profile deleted","tokenCopied":"Token copied to clipboard","logsCopied":"Logs copied to clipboard","fillAllFields":"Please fill all IMAP fields","clipboardError":"Failed to read clipboard","deleteProfileConfirm":"Delete this profile?","deleteBadAccountsConfirm":"Delete all expired/exhausted accounts?","deleteBannedAccountsConfirm":"Delete all banned accounts?","bannedAccountsDeleted":"Banned accounts deleted","emailsImported":"Imported {count} emails","exportAccounts":"Export Accounts","exportAccountsDesc":"Export accounts with tokens for transfer","importAccounts":"Import Accounts","importAccountsDesc":"Import accounts from export file","exportSelected":"Export Selected","exportAll":"Export All","selectMode":"Select","selected":"selected","selectAll":"Select All","deselectAll":"Deselect All","refreshSelected":"Refresh Tokens","deleteSelected":"Delete Selected","deleteSelectedConfirm":"Delete {count} selected accounts?","selectedAccountsDeleted":"{count} accounts deleted","refreshingTokens":"Refreshing tokens...","checkHealth":"Check Health","checkingHealth":"Checking accounts health...","ready":"Ready","clickToConfigure":"Click to configure","noAccountsFound":"No accounts found","clearSearch":"Clear search","automation":"Automation","interface":"Interface","autoSwitchThreshold":"Switch threshold","autoSwitchThresholdDesc":"Switch when remaining < this value","settings":"Settings","accounts":"Accounts","profiles":"Profiles","pause":"Pause","statistics":"Statistics","weeklyUsage":"Weekly Usage","avgPerAccount":"Avg per account","accountHealth":"Account Health"};
    
    // WebSocket connection
    let ws = null;
    let reconnectAttempts = 0;
    
    function connectWebSocket() {
      const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
      ws = new WebSocket(protocol + '//' + window.location.host + '/ws');
      
      ws.onopen = () => {
        console.log('WebSocket connected');
        reconnectAttempts = 0;
        sendCommand('refresh');
        sendCommand('getPatchStatus');
        sendCommand('getActiveProfile');
      };
      
      ws.onmessage = (event) => {
        try {
          const msg = JSON.parse(event.data);
          handleMessage(msg);
        } catch (e) {
          console.error('Failed to parse message:', e);
        }
      };
      
      ws.onclose = () => {
        console.log('WebSocket disconnected');
        if (reconnectAttempts < 5) {
          reconnectAttempts++;
          setTimeout(connectWebSocket, 1000 * reconnectAttempts);
        }
      };
      
      ws.onerror = (error) => {
        console.error('WebSocket error:', error);
      };
    }
    
    function sendCommand(command, data = {}) {
      if (ws && ws.readyState === WebSocket.OPEN) {
        ws.send(JSON.stringify({ command, ...data }));
      }
    }
    
    // Message handler - same as extension
    function handleMessage(msg) {
      switch (msg.type) {
        case 'accountsLoaded':
          renderAccounts(msg.accounts);
          break;
        case 'appendLog':
          appendLogLine(msg.log);
          break;
        case 'updateStatus':
          updateStatus(msg.status);
          break;
        case 'toast':
          showToast(msg.message, msg.toastType || 'success');
          break;
        case 'profilesLoaded':
          renderProfilesList(msg.profiles, msg.activeProfileId);
          break;
        case 'activeProfileLoaded':
          renderActiveProfile(msg.profile);
          break;
        case 'profileLoaded':
          populateProfileEditor(msg.profile);
          break;
        case 'patchStatus':
          updatePatchStatus(msg);
          break;
      }
    }
    
    // UI Functions (same as extension, but using sendCommand instead of vscode.postMessage)
    let pendingAction = null;
    let currentPoolEmails = [];
    let editingProfileId = null;
    
    function openSettings() {
      document.getElementById('settingsOverlay')?.classList.add('visible');
      sendCommand('getActiveProfile');
      sendCommand('getPatchStatus');
    }
    
    function closeSettings() {
      document.getElementById('settingsOverlay')?.classList.remove('visible');
    }
    
    function toggleLogs() {
      document.getElementById('logsDrawer')?.classList.toggle('open');
    }
    
    function startAutoReg() {
      sendCommand('startAutoReg');
    }
    
    function stopAutoReg() {
      sendCommand('stopAutoReg');
    }
    
    function refresh() {
      sendCommand('refresh');
    }
    
    function switchAccount(filename) {
      sendCommand('switchAccount', { email: filename });
    }
    
    function copyToken(filename) {
      sendCommand('copyToken', { email: filename });
    }
    
    function refreshToken(filename) {
      sendCommand('refreshToken', { email: filename });
    }
    
    function confirmDelete(filename) {
      pendingAction = { type: 'delete', filename };
      document.getElementById('dialogTitle').textContent = T.deleteTitle;
      document.getElementById('dialogText').textContent = T.areYouSure;
      document.getElementById('dialogOverlay').classList.add('visible');
    }
    
    function closeDialog() {
      document.getElementById('dialogOverlay').classList.remove('visible');
      pendingAction = null;
    }
    
    function dialogAction() {
      if (pendingAction?.type === 'delete') {
        sendCommand('deleteAccount', { email: pendingAction.filename });
        showToast(T.accountDeleted, 'success');
      } else if (pendingAction?.type === 'deleteExhausted') {
        sendCommand('deleteExhaustedAccounts');
        showToast(T.badAccountsDeleted || 'Bad accounts deleted', 'success');
      } else if (pendingAction?.type === 'deleteBanned') {
        sendCommand('deleteBannedAccounts');
        showToast(T.bannedAccountsDeleted || 'Banned accounts deleted', 'success');
      } else if (pendingAction?.type === 'deleteSelected') {
        sendCommand('deleteSelectedAccounts', { filenames: pendingAction.filenames });
        showToast((T.selectedAccountsDeleted || '{count} accounts deleted').replace('{count}', pendingAction.filenames.length), 'success');
        selectionMode = false;
        selectedAccounts.clear();
        const bar = document.getElementById('bulkActionsBar');
        if (bar) bar.classList.add('hidden');
      }
      closeDialog();
    }
    
    function showToast(message, type = 'success') {
      const container = document.getElementById('toastContainer');
      if (!container) return;
      
      const toast = document.createElement('div');
      toast.className = 'toast ' + type;
      const icons = { success: 'âœ“', error: 'âœ—', warning: 'âš ï¸' };
      toast.innerHTML = '<span class="toast-icon">' + (icons[type] || 'â€¢') + '</span><span class="toast-message">' + message + '</span>';
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.classList.add('removing');
        setTimeout(() => toast.remove(), 200);
      }, 3000);
    }
    
    function appendLogLine(log) {
      const content = document.getElementById('logsContent');
      if (!content) return;
      
      document.getElementById('logsDrawer')?.classList.add('open');
      
      const line = document.createElement('div');
      line.className = 'log-line';
      if (log.includes('âœ“') || log.includes('SUCCESS') || log.includes('[OK]')) line.classList.add('success');
      else if (log.includes('âœ—') || log.includes('ERROR') || log.includes('[X]')) line.classList.add('error');
      else if (log.includes('âš ') || log.includes('WARN') || log.includes('[!]')) line.classList.add('warning');
      line.textContent = log;
      content.appendChild(line);
      
      while (content.children.length > 200) content.removeChild(content.firstChild);
      content.scrollTop = content.scrollHeight;
      
      const countEl = document.getElementById('logsCount');
      if (countEl) countEl.textContent = content.children.length.toString();
    }
    
    function updateStatus(status) {
      const btn = document.querySelector('.btn-primary');
      if (!status) {
        if (btn) {
          btn.disabled = false;
          btn.innerHTML = 'âš¡ ' + T.autoReg;
        }
        sendCommand('refresh');
        return;
      }
      
      if (btn) {
        btn.disabled = true;
        btn.innerHTML = '<span class="spinner"></span> ' + T.running;
      }
    }
    
    function renderAccounts(accounts) {
      const list = document.getElementById('accountList');
      if (!list || !accounts) return;
      
      // Group accounts
      const active = accounts.filter(a => a.isActive);
      const ready = accounts.filter(a => !a.isActive && !a.isExpired);
      const expired = accounts.filter(a => a.isExpired);
      
      let html = '';
      
      if (active.length > 0) {
        html += '<div class="account-group"><div class="account-group-header"><span class="account-group-title">Active</span><span class="account-group-count">' + active.length + '</span></div>';
        active.forEach(a => { html += renderAccountCard(a); });
        html += '</div>';
      }
      
      if (ready.length > 0) {
        html += '<div class="account-group"><div class="account-group-header"><span class="account-group-title">Ready</span><span class="account-group-count">' + ready.length + '</span></div>';
        ready.forEach(a => { html += renderAccountCard(a); });
        html += '</div>';
      }
      
      if (expired.length > 0) {
        html += '<div class="account-group collapsed"><div class="account-group-header"><span class="account-group-title">Expired</span><span class="account-group-count">' + expired.length + '</span></div>';
        expired.forEach(a => { html += renderAccountCard(a); });
        html += '</div>';
      }
      
      list.innerHTML = html;
    }
    
    function renderAccountCard(account) {
      const initial = (account.email || account.filename || '?')[0].toUpperCase();
      const name = account.email?.split('@')[0] || account.filename?.replace('.json', '') || 'Unknown';
      const status = account.isExpired ? 'expired' : (account.isActive ? 'active' : 'ready');
      
      return '<div class="account ' + status + '" onclick="switchAccount(\'' + account.filename + '\')">' +
        '<div class="account-avatar">' + initial + '</div>' +
        '<div class="account-info">' +
          '<div class="account-email">' + name + '</div>' +
          '<div class="account-meta">' +
            '<span class="account-usage">ðŸ“Š ' + (account.isExpired ? 'expired' : '0h') + '</span>' +
            '<span class="account-region">ðŸŒ ' + (account.region || 'us-east-1') + '</span>' +
          '</div>' +
        '</div>' +
        '<div class="account-actions">' +
          '<button class="icon-btn" onclick="event.stopPropagation(); refreshToken(\'' + account.filename + '\')">ðŸ”„</button>' +
          '<button class="icon-btn danger" onclick="event.stopPropagation(); confirmDelete(\'' + account.filename + '\')">ðŸ—‘ï¸</button>' +
        '</div>' +
      '</div>';
    }
    
    // Profile functions
    function openProfilesPanel() {
      // Close settings first to avoid overlap
      document.getElementById('settingsOverlay')?.classList.remove('visible');
      document.getElementById('profilesPanel')?.classList.add('visible');
      sendCommand('loadProfiles');
    }
    
    function closeProfilesPanel() {
      document.getElementById('profilesPanel')?.classList.remove('visible');
      // Reopen settings
      document.getElementById('settingsOverlay')?.classList.add('visible');
    }
    
    function createProfile() {
      editingProfileId = null;
      currentPoolEmails = [];
      // Close profiles panel first
      document.getElementById('profilesPanel')?.classList.remove('visible');
      document.getElementById('profileEditor')?.classList.add('visible');
      document.getElementById('profileName').value = '';
      document.getElementById('imapUser').value = '';
      document.getElementById('imapServer').value = '';
      document.getElementById('imapPort').value = '993';
      document.getElementById('imapPassword').value = '';
      selectStrategy('single');
    }
    
    function selectStrategy(strategy) {
      document.querySelectorAll('.strategy-option').forEach(el => {
        el.classList.toggle('selected', el.dataset.strategy === strategy);
      });
      const catchAllConfig = document.getElementById('catchAllConfig');
      const poolConfig = document.getElementById('poolConfig');
      const imapEmailGroup = document.getElementById('imapEmailGroup');
      const imapPasswordGroup = document.getElementById('imapPasswordGroup');
      
      if (catchAllConfig) catchAllConfig.style.display = strategy === 'catch_all' ? 'block' : 'none';
      if (poolConfig) poolConfig.style.display = strategy === 'pool' ? 'block' : 'none';
      
      const isPool = strategy === 'pool';
      if (imapEmailGroup) imapEmailGroup.style.display = isPool ? 'none' : 'block';
      if (imapPasswordGroup) imapPasswordGroup.style.display = isPool ? 'none' : 'block';
    }
    
    function closeProfileEditor() {
      document.getElementById('profileEditor')?.classList.remove('visible');
      editingProfileId = null;
      // Reopen profiles panel
      document.getElementById('profilesPanel')?.classList.add('visible');
      sendCommand('loadProfiles');
    }
    
    function saveProfile() {
      const name = document.getElementById('profileName')?.value?.trim() || T.unnamed;
      const server = document.getElementById('imapServer')?.value?.trim();
      const user = document.getElementById('imapUser')?.value?.trim();
      const password = document.getElementById('imapPassword')?.value;
      const port = parseInt(document.getElementById('imapPort')?.value) || 993;
      
      const selectedStrategy = document.querySelector('.strategy-option.selected');
      const strategyType = selectedStrategy?.dataset?.strategy || 'single';
      
      const strategy = { type: strategyType };
      if (strategyType === 'catch_all') {
        strategy.domain = document.getElementById('catchAllDomain')?.value?.trim();
      } else if (strategyType === 'pool') {
        strategy.emails = currentPoolEmails.map(item => ({
          email: item.email || item,
          password: item.password,
          status: 'pending'
        }));
      }
      
      const isPool = strategyType === 'pool';
      
      if (isPool) {
        if (!currentPoolEmails || currentPoolEmails.length === 0) {
          showToast(T.poolEmpty || 'Add at least one email to pool', 'error');
          return;
        }
        const firstEntry = currentPoolEmails[0];
        sendCommand(editingProfileId ? 'updateProfile' : 'createProfile', {
          profile: {
            id: editingProfileId,
            name,
            imap: { server, user: firstEntry.email || firstEntry, password: firstEntry.password || '', port },
            strategy
          }
        });
      } else {
        if (!server || !user || !password) {
          showToast(T.fillAllFields, 'error');
          return;
        }
        sendCommand(editingProfileId ? 'updateProfile' : 'createProfile', {
          profile: {
            id: editingProfileId,
            name,
            imap: { server, user, password, port },
            strategy
          }
        });
      }
      
      closeProfileEditor();
    }
    
    function renderProfilesList(profiles, activeId) {
      const container = document.getElementById('profilesContent');
      if (!container) return;
      
      if (!profiles || profiles.length === 0) {
        container.innerHTML = '<div class="profiles-empty"><div class="empty-icon">ðŸ“§</div><div class="empty-text">' + T.noProfiles + '</div><button class="btn btn-primary" onclick="createProfile()">+ ' + T.addProfile + '</button></div>';
        return;
      }
      
      let html = '<div class="profiles-list">';
      profiles.forEach(profile => {
        const isActive = profile.id === activeId;
        html += '<div class="profile-card ' + (isActive ? 'active' : '') + '">' +
          '<div class="profile-card-header">' +
            '<div class="profile-card-radio" onclick="selectProfile(\'' + profile.id + '\')">' +
              '<span class="radio-dot ' + (isActive ? 'checked' : '') + '"></span>' +
            '</div>' +
            '<div class="profile-card-info">' +
              '<div class="profile-card-name">' + (profile.name || T.unnamed) + '</div>' +
              '<div class="profile-card-email">' + (profile.imap?.user || '') + '</div>' +
            '</div>' +
          '</div>' +
        '</div>';
      });
      html += '</div>';
      html += '<button class="btn btn-primary profiles-add-btn" onclick="createProfile()">+ ' + T.addProfile + '</button>';
      container.innerHTML = html;
    }
    
    function selectProfile(profileId) {
      sendCommand('setActiveProfile', { profileId });
    }
    
    // Store current active profile for Hero display
    let currentActiveProfile = null;
    
    function renderActiveProfile(profile) {
      currentActiveProfile = profile;
      
      // Update Settings panel
      const container = document.getElementById('activeProfileContent');
      if (container) {
        if (!profile) {
          container.innerHTML = '<div class="active-profile-empty"><span class="empty-icon">ðŸ“§</span><span class="empty-text">' + T.noProfileConfigured + '</span><button class="btn btn-primary btn-sm" onclick="openProfilesPanel()">' + T.configure + '</button></div>';
        } else {
          container.innerHTML = '<div class="active-profile-info"><div class="active-profile-name">' + (profile.name || T.unnamed) + '</div><div class="active-profile-email">' + (profile.imap?.user || '') + '</div></div>';
        }
      }
      
      // Update Hero section to show profile info
      updateHeroWithProfile(profile);
    }
    
    function updateHeroWithProfile(profile) {
      const hero = document.querySelector('.hero');
      if (!hero) return;
      
      // Don't update if registration is running (hero shows progress)
      if (hero.classList.contains('progress')) return;
      
      if (!profile) {
        hero.className = 'hero empty';
        hero.setAttribute('onclick', 'openSettings()');
        hero.innerHTML = '<div class="hero-email">' + T.noActive + '</div><div class="hero-hint">' + (T.clickToConfigure || 'Click to configure') + '</div>';
        return;
      }
      
      const profileName = profile.name || T.unnamed || 'Unnamed';
      const email = profile.imap?.user || '';
      const strategyType = profile.strategy?.type || 'single';
      const strategyIcon = strategyType === 'pool' ? 'ðŸ“¦' : strategyType === 'catch_all' ? 'ðŸŽ¯' : 'ðŸ“§';
      const registered = profile.stats?.registered || 0;
      const failed = profile.stats?.failed || 0;
      
      hero.className = 'hero profile';
      hero.setAttribute('onclick', 'openSettings()');
      hero.innerHTML = 
        '<div class="hero-header">' +
          '<span class="hero-email" title="' + email + '">' + strategyIcon + ' ' + profileName + '</span>' +
          '<span class="hero-days">' + (T.ready || 'Ready') + '</span>' +
        '</div>' +
        '<div class="hero-profile-info">' +
          '<span class="hero-profile-email">' + email + '</span>' +
        '</div>' +
        '<div class="hero-stats">' +
          '<span class="hero-usage font-mono">âœ… ' + registered + ' / âŒ ' + failed + '</span>' +
          '<span class="hero-percent">' + (T.clickToConfigure || 'Click to configure') + '</span>' +
        '</div>';
    }
    
    function updatePatchStatus(status) {
      const statusEl = document.getElementById('patchStatusText');
      if (statusEl) {
        if (status.isPatched) {
          statusEl.textContent = T.patchStatusActive + ' âœ“';
          statusEl.className = 'patch-status success';
        } else {
          statusEl.textContent = T.patchStatusNotPatched;
          statusEl.className = 'patch-status warning';
        }
      }
    }
    
    // Settings toggles
    function toggleAutoSwitch(enabled) {
      sendCommand('toggleAutoSwitch', { enabled });
    }
    
    function toggleSetting(key, value) {
      sendCommand('updateSetting', { key, value });
    }
    
    function changeLanguage(lang) {
      sendCommand('setLanguage', { language: lang });
    }
    
    // Pool email functions
    function addEmailToPool() {
      const input = document.getElementById('newPoolEmail');
      const value = input?.value?.trim();
      if (!value || !value.includes('@')) return;
      
      let email, password;
      if (value.includes(':') && value.indexOf(':') > value.indexOf('@')) {
        const colonPos = value.lastIndexOf(':');
        email = value.substring(0, colonPos);
        password = value.substring(colonPos + 1);
      } else {
        email = value;
      }
      
      if (!currentPoolEmails.find(e => (e.email || e).toLowerCase() === email.toLowerCase())) {
        currentPoolEmails.push(password ? { email, password } : { email });
        renderPoolList();
      }
      if (input) input.value = '';
    }
    
    function removeEmailFromPool(index) {
      currentPoolEmails.splice(index, 1);
      renderPoolList();
    }
    
    function renderPoolList() {
      const list = document.getElementById('poolList');
      if (!list) return;
      list.innerHTML = currentPoolEmails.map((item, i) => {
        const email = item.email || item;
        const hasPassword = item.password ? ' ðŸ”‘' : '';
        return '<div class="pool-item pending"><span class="pool-status">â¬œ</span><span class="pool-email">' + email + hasPassword + '</span><button class="pool-remove" onclick="removeEmailFromPool(' + i + ')">âœ•</button></div>';
      }).join('');
    }
    
    function pasteEmails() {
      navigator.clipboard.readText().then(text => {
        const lines = text.split(/[\r\n]+/).filter(e => e.includes('@'));
        lines.forEach(line => {
          const trimmed = line.trim();
          let email, password;
          if (trimmed.includes(':') && trimmed.indexOf(':') > trimmed.indexOf('@')) {
            const colonPos = trimmed.lastIndexOf(':');
            email = trimmed.substring(0, colonPos);
            password = trimmed.substring(colonPos + 1);
          } else {
            email = trimmed;
          }
          if (!currentPoolEmails.find(e => (e.email || e).toLowerCase() === email.toLowerCase())) {
            currentPoolEmails.push(password ? { email, password } : { email });
          }
        });
        renderPoolList();
      }).catch(() => showToast('Clipboard error', 'error'));
    }
    
    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      connectWebSocket();
    });
    
    // Additional functions
    function editProfile(profileId) {
      editingProfileId = profileId;
      sendCommand('getProfile', { profileId });
    }
    
    function deleteProfile(profileId) {
      if (confirm(T.deleteProfileConfirm || 'Delete this profile?')) {
        sendCommand('deleteProfile', { profileId });
      }
    }
    
    function populateProfileEditor(profile) {
      if (!profile) return;
      
      editingProfileId = profile.id;
      
      const nameEl = document.getElementById('profileName');
      const userEl = document.getElementById('imapUser');
      const serverEl = document.getElementById('imapServer');
      const portEl = document.getElementById('imapPort');
      const passwordEl = document.getElementById('imapPassword');
      
      if (nameEl) nameEl.value = profile.name || '';
      if (userEl) userEl.value = profile.imap?.user || '';
      if (serverEl) serverEl.value = profile.imap?.server || '';
      if (portEl) portEl.value = profile.imap?.port || 993;
      if (passwordEl) passwordEl.value = profile.imap?.password || '';
      
      const strategyType = profile.strategy?.type || 'single';
      selectStrategy(strategyType);
      
      if (strategyType === 'catch_all' && profile.strategy?.domain) {
        const domainEl = document.getElementById('catchAllDomain');
        if (domainEl) domainEl.value = profile.strategy.domain;
      }
      
      if (strategyType === 'pool' && profile.strategy?.emails) {
        currentPoolEmails = profile.strategy.emails.map(e => 
          typeof e === 'string' ? { email: e } : e
        );
        renderPoolList();
      }
      
      document.getElementById('profileEditor')?.classList.add('visible');
    }
    
    function clearConsole() {
      const content = document.getElementById('logsContent');
      if (content) content.innerHTML = '';
      const countEl = document.getElementById('logsCount');
      if (countEl) countEl.textContent = '0';
    }
    
    function copyLogs() {
      const content = document.getElementById('logsContent');
      if (content) {
        const logs = Array.from(content.querySelectorAll('.log-line'))
          .map(el => el.textContent)
          .join('\n');
        navigator.clipboard.writeText(logs).then(() => {
          showToast('Logs copied', 'success');
        });
      }
    }
    
    function togglePasswordVisibility(inputId) {
      const input = document.getElementById(inputId);
      if (input) input.type = input.type === 'password' ? 'text' : 'password';
    }
    
    function testImapConnection() {
      const server = document.getElementById('imapServer')?.value;
      const user = document.getElementById('imapUser')?.value;
      const password = document.getElementById('imapPassword')?.value;
      const port = document.getElementById('imapPort')?.value || '993';
      sendCommand('testImap', { server, user, password, port: parseInt(port) });
    }
    
    function importEmailsFromFile() {
      // Create file input
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.txt,.csv';
      input.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (ev) => {
            const text = ev.target.result;
            const lines = text.split(/[\r\n]+/).filter(e => e.includes('@'));
            lines.forEach(line => {
              const trimmed = line.trim();
              let email, password;
              if (trimmed.includes(':') && trimmed.indexOf(':') > trimmed.indexOf('@')) {
                const colonPos = trimmed.lastIndexOf(':');
                email = trimmed.substring(0, colonPos);
                password = trimmed.substring(colonPos + 1);
              } else {
                email = trimmed;
              }
              if (!currentPoolEmails.find(e => (e.email || e).toLowerCase() === email.toLowerCase())) {
                currentPoolEmails.push(password ? { email, password } : { email });
              }
            });
            renderPoolList();
            showToast('Imported ' + lines.length + ' emails', 'success');
          };
          reader.readAsText(file);
        }
      };
      input.click();
    }
    
    function refreshUsage() {
      sendCommand('refreshUsage');
    }
    
    function onEmailInput(email) {
      // Auto-detect provider (simplified for standalone)
      if (email.includes('@gmail.com')) {
        document.getElementById('imapServer').value = 'imap.gmail.com';
      } else if (email.includes('@gmx.')) {
        document.getElementById('imapServer').value = 'imap.gmx.com';
      } else if (email.includes('@outlook.') || email.includes('@hotmail.')) {
        document.getElementById('imapServer').value = 'outlook.office365.com';
      }
    }
    
    function confirmDeleteExhausted() {
      pendingAction = { type: 'deleteExhausted' };
      document.getElementById('dialogTitle').textContent = T.deleteTitle;
      document.getElementById('dialogText').textContent = T.deleteBadAccountsConfirm || 'Delete all exhausted accounts?';
      document.getElementById('dialogOverlay').classList.add('visible');
    }
    
    function confirmDeleteBanned() {
      pendingAction = { type: 'deleteBanned' };
      document.getElementById('dialogTitle').textContent = T.deleteTitle;
      document.getElementById('dialogText').textContent = T.deleteBannedAccountsConfirm || 'Delete all banned accounts?';
      document.getElementById('dialogOverlay').classList.add('visible');
    }
    
    function refreshAllExpired() {
      sendCommand('refreshAllExpired');
    }
    
    function checkAllAccountsHealth() {
      sendCommand('checkAllAccountsHealth');
      showToast(T.checkingHealth || 'Checking accounts health...', 'success');
    }
    
    function exportAllAccounts() {
      sendCommand('exportAccounts');
    }
    
    function importAccounts() {
      sendCommand('importAccounts');
    }
    
    // === Selection Mode (Bulk Actions) ===
    
    let selectionMode = false;
    let selectedAccounts = new Set();
    
    function toggleSelectionMode() {
      selectionMode = !selectionMode;
      selectedAccounts.clear();
      
      // Toggle bulk actions bar visibility
      const bar = document.getElementById('bulkActionsBar');
      const selectBtn = document.getElementById('selectModeBtn');
      if (bar) bar.classList.toggle('hidden', !selectionMode);
      if (selectBtn) selectBtn.classList.toggle('active', selectionMode);
      
      // Toggle checkbox visibility - add/remove checkboxes dynamically
      document.querySelectorAll('.account').forEach(card => {
        let checkbox = card.querySelector('.account-checkbox');
        if (selectionMode) {
          if (!checkbox) {
            const filename = card.dataset.filename;
            checkbox = document.createElement('label');
            checkbox.className = 'account-checkbox';
            checkbox.onclick = (e) => e.stopPropagation();
            checkbox.innerHTML = '<input type="checkbox" data-filename="' + filename + '" onchange="toggleAccountSelection(\'' + filename + '\', this.checked)"><span class="checkmark"></span>';
            card.insertBefore(checkbox, card.firstChild);
          }
        } else {
          if (checkbox) checkbox.remove();
          card.classList.remove('selected');
        }
      });
      
      updateBulkActionsBar();
    }
    
    function toggleAccountSelection(filename, checked) {
      if (checked) {
        selectedAccounts.add(filename);
      } else {
        selectedAccounts.delete(filename);
      }
      
      const card = document.querySelector('.account[data-filename="' + filename + '"]');
      if (card) card.classList.toggle('selected', checked);
      
      updateBulkActionsBar();
    }
    
    function selectAllAccounts() {
      document.querySelectorAll('.account-checkbox input').forEach(cb => {
        cb.checked = true;
        const filename = cb.dataset.filename;
        if (filename) selectedAccounts.add(filename);
      });
      document.querySelectorAll('.account').forEach(card => card.classList.add('selected'));
      updateBulkActionsBar();
    }
    
    function deselectAllAccounts() {
      document.querySelectorAll('.account-checkbox input').forEach(cb => {
        cb.checked = false;
      });
      document.querySelectorAll('.account').forEach(card => card.classList.remove('selected'));
      selectedAccounts.clear();
      updateBulkActionsBar();
    }
    
    function updateBulkActionsBar() {
      const countEl = document.getElementById('bulkCount');
      if (countEl) {
        countEl.textContent = selectedAccounts.size.toString();
      }
    }
    
    function exportSelectedAccounts() {
      if (selectedAccounts.size === 0) return;
      sendCommand('exportSelectedAccounts', { filenames: Array.from(selectedAccounts) });
    }
    
    function refreshSelectedTokens() {
      if (selectedAccounts.size === 0) return;
      sendCommand('refreshSelectedTokens', { filenames: Array.from(selectedAccounts) });
      showToast(T.refreshingTokens || 'Refreshing tokens...', 'success');
    }
    
    function deleteSelectedAccounts() {
      if (selectedAccounts.size === 0) return;
      pendingAction = { type: 'deleteSelected', filenames: Array.from(selectedAccounts) };
      document.getElementById('dialogTitle').textContent = T.deleteTitle;
      document.getElementById('dialogText').textContent = (T.deleteSelectedConfirm || 'Delete {count} selected accounts?').replace('{count}', selectedAccounts.size);
      document.getElementById('dialogOverlay').classList.add('visible');
    }
    
    // Export to window
    window.openSettings = openSettings;
    window.closeSettings = closeSettings;
    window.toggleLogs = toggleLogs;
    window.startAutoReg = startAutoReg;
    window.stopAutoReg = stopAutoReg;
    window.refresh = refresh;
    window.switchAccount = switchAccount;
    window.copyToken = copyToken;
    window.refreshToken = refreshToken;
    window.confirmDelete = confirmDelete;
    window.closeDialog = closeDialog;
    window.dialogAction = dialogAction;
    window.showToast = showToast;
    window.openProfilesPanel = openProfilesPanel;
    window.closeProfilesPanel = closeProfilesPanel;
    window.createProfile = createProfile;
    window.selectStrategy = selectStrategy;
    window.closeProfileEditor = closeProfileEditor;
    window.saveProfile = saveProfile;
    window.selectProfile = selectProfile;
    window.toggleAutoSwitch = toggleAutoSwitch;
    window.toggleSetting = toggleSetting;
    window.changeLanguage = changeLanguage;
    window.addEmailToPool = addEmailToPool;
    window.removeEmailFromPool = removeEmailFromPool;
    window.pasteEmails = pasteEmails;
    window.editProfile = editProfile;
    window.deleteProfile = deleteProfile;
    window.clearConsole = clearConsole;
    window.copyLogs = copyLogs;
    window.togglePasswordVisibility = togglePasswordVisibility;
    window.testImapConnection = testImapConnection;
    window.importEmailsFromFile = importEmailsFromFile;
    window.refreshUsage = refreshUsage;
    window.onEmailInput = onEmailInput;
    window.confirmDeleteExhausted = confirmDeleteExhausted;
    window.confirmDeleteBanned = confirmDeleteBanned;
    window.checkAllAccountsHealth = checkAllAccountsHealth;
    window.refreshAllExpired = refreshAllExpired;
    window.exportAllAccounts = exportAllAccounts;
    window.importAccounts = importAccounts;
    window.renderActiveProfile = renderActiveProfile;
    window.toggleSelectionMode = toggleSelectionMode;
    window.toggleAccountSelection = toggleAccountSelection;
    window.selectAllAccounts = selectAllAccounts;
    window.deselectAllAccounts = deselectAllAccounts;
    window.exportSelectedAccounts = exportSelectedAccounts;
    window.refreshSelectedTokens = refreshSelectedTokens;
    window.deleteSelectedAccounts = deleteSelectedAccounts;
  </script>
</body>
</html>